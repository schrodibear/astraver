(* This file was originally generated by why.
   It can be modified; only the generated parts will be overwritten. *)

Require Export caduceus_spec_why.

(* Why obligation from file "why/average.why", characters 440-468 *)
Lemma average_impl_po_1 : 
  forall (t: pointer),
  forall (n: Z),
  forall (alloc: alloc_table),
  forall (intP: ((memory) Z)),
  forall (Pre7: (valid_range alloc t 0 n) /\ n > 0),
  forall (sum: Z),
  forall (Post6: sum = 0),
  forall (i1: Z),
  forall (Post1: i1 = 0),
  forall (Variant1: Z),
  forall (i2: Z),
  forall (sum1: Z),
  forall (Pre5: Variant1 = (n - i2)),
  forall (Pre4: (0 <= i2 /\ i2 <= n) /\ (i2 * (min intP t i2)) <= sum1),
  forall (Test2: i2 < n),
  forall (aux_1: pointer),
  forall (Post13: aux_1 = (shift t i2)),
  (valid alloc aux_1).
Proof.
intuition.
subst; auto.
Save.

(* Why obligation from file "why/average.why", characters 440-468 *)
Lemma average_impl_po_2 : 
  forall (t: pointer),
  forall (n: Z),
  forall (alloc: alloc_table),
  forall (intP: ((memory) Z)),
  forall (Pre7: (valid_range alloc t 0 n) /\ n > 0),
  forall (sum: Z),
  forall (Post6: sum = 0),
  forall (i1: Z),
  forall (Post1: i1 = 0),
  forall (Variant1: Z),
  forall (i2: Z),
  forall (sum1: Z),
  forall (Pre5: Variant1 = (n - i2)),
  forall (Pre4: (0 <= i2 /\ i2 <= n) /\ (i2 * (min intP t i2)) <= sum1),
  forall (Test2: i2 < n),
  forall (aux_1: pointer),
  forall (Post13: aux_1 = (shift t i2)),
  forall (Pre2: (valid alloc aux_1)),
  forall (result1: Z),
  forall (Post15: result1 = (acc intP aux_1)),
  (sum1 + result1) = (sum1 + (acc intP (shift t i2))).
Proof.
intuition; subst; auto.
Qed.

(* Why obligation from file "why/average.why", characters 417-498 *)
Lemma average_impl_po_3 : 
  forall (t: pointer),
  forall (n: Z),
  forall (alloc: alloc_table),
  forall (intP: ((memory) Z)),
  forall (Pre7: (valid_range alloc t 0 n) /\ n > 0),
  forall (sum: Z),
  forall (Post6: sum = 0),
  forall (i1: Z),
  forall (Post1: i1 = 0),
  forall (Variant1: Z),
  forall (i2: Z),
  forall (sum1: Z),
  forall (Pre5: Variant1 = (n - i2)),
  forall (Pre4: (0 <= i2 /\ i2 <= n) /\ (i2 * (min intP t i2)) <= sum1),
  forall (Test2: i2 < n),
  forall (sum2: Z),
  forall (Post3: sum2 = (sum1 + (acc intP (shift t i2)))),
  forall (i3: Z),
  forall (Post4: i3 = (i2 + 1)),
  ((0 <= i3 /\ i3 <= n) /\ (i3 * (min intP t i3)) <= sum2) /\
  (Zwf 0 (n - i3) (n - i2)).
Proof.
intuition.
subst.




assert (i2 = n). omega. subst.
replace (min intP t n) with ((0 + min intP t n * n) / n).
apply Zge_le.
apply Z_div_ge; auto.
rewrite Zmult_comm.
omega.
rewrite Z_div_plus; auto.
Save.

(* Why obligation from file "why/average.why", characters 241-505 *)
Lemma average_impl_po_4 : 
  forall (t: pointer),
  forall (n: Z),
  forall (alloc: alloc_table),
  forall (intP: ((memory) Z)),
  forall (Pre7: (valid_range alloc t 0 n) /\ n > 0),
  forall (sum: Z),
  forall (Post6: sum = 0),
  forall (i1: Z),
  forall (Post1: i1 = 0),
  forall (Variant1: Z),
  forall (i2: Z),
  forall (sum1: Z),
  forall (Pre5: Variant1 = (n - i2)),
  forall (Pre4: (0 <= i2 /\ i2 <= n) /\ (i2 * (min intP t i2)) <= sum1),
  forall (Test1: i2 >= n),
  (forall (result:Z), (result = ((Zdiv sum1 n)) -> (min intP t n) <= result)) /\
  ~(n = 0).
Proof.
intuition.
subst; omega.
Qed.

(* Why obligation from file "why/average.why", characters 292-378 *)
Lemma average_impl_po_5 : 
  forall (t: pointer),
  forall (n: Z),
  forall (alloc: alloc_table),
  forall (intP: ((memory) Z)),
  forall (Pre7: (valid_range alloc t 0 n) /\ n > 0),
  forall (sum: Z),
  forall (Post6: sum = 0),
  forall (i1: Z),
  forall (Post1: i1 = 0),
  (0 <= i1 /\ i1 <= n) /\ (i1 * (min intP t i1)) <= sum.
Proof.
intuition.
(* FILL PROOF HERE *)
Save.

(* Why obligation from file "why/average.why", characters 765-792 *)
Lemma min_impl_po_1 : 
  forall (t: pointer),
  forall (n: Z),
  forall (alloc: alloc_table),
  forall (Pre10: n > 0 /\ (valid_range alloc t 0 n)),
  (valid alloc (shift t 0)).
Proof.
intuition.
subst; auto.
Save.

(* Why obligation from file "why/average.why", characters 1015-1099 *)
Lemma min_impl_po_2 : 
  forall (t: pointer),
  forall (n: Z),
  forall (alloc: alloc_table),
  forall (intP: ((memory) Z)),
  forall (Pre10: n > 0 /\ (valid_range alloc t 0 n)),
  forall (Pre9: (valid alloc (shift t 0))),
  forall (tmp: Z),
  forall (Post8: tmp = (acc intP (shift t 0))),
  forall (i1: Z),
  forall (Post1: i1 = 1),
  forall (Variant1: Z),
  forall (i2: Z),
  forall (tmp1: Z),
  forall (Pre7: Variant1 = (n - i2)),
  forall (Pre6: (1 <= i2 /\ i2 <= n) /\ (is_min alloc intP t i2 tmp1)),
  forall (Test4: i2 < n),
  (valid alloc (shift t i2)).
Proof.
unfold is_min; intuition; subst; auto with *.
assert (i1=0). omega.
subst; intuition.
exists 0; intuition.
assert (i3<i1 \/ i3=i1). omega. intuition.
generalize (H3 i3); intuition.
subst; omega.
exists i1; intuition.
assert (i3<i1 \/ i3=i1). omega. intuition.
subst; omega.
elim H6; intros i2 Hi2; exists i2; intuition.
assert (i1=n). omega. subst; trivial.
Save.

Proof.
intuition.
(* FILL PROOF HERE *)
assert (i2=0 \/ i2>0). omega. intuition.
subst; ring (0+1).
assert (min intP t 1 = shift t 0 # intP).
generalize (min_is_min alloc intP t 1).
assert (1>0). omega. unfold is_min in *|-*. intuition.
elim H7; intros i Hi. assert (i=0). omega.
subst; intuition.
omega.
replace ((i2 + 1) * min intP t (i2 + 1)) with ((i2 * min intP t (i2+1)) + min intP t (i2+1)).
2:ring.
assert (min intP t (i2 + 1) <= min intP t i2).
generalize (min_is_min alloc intP t i2).
assert (i2+1>0). omega.
generalize (min_is_min alloc intP t (i2+1)).
unfold is_min; intuition.
elim H9; intros i Hi.
intuition.
rewrite H11.
intuition.
assert (i2 * min intP t (i2 + 1) <= i2 * min intP t i2).
apply Zmult_le_compat_l; auto with *.
assert (min intP t (i2 + 1) <= shift t i2 # intP).
assert (i2+1>0). omega.
generalize (min_is_min alloc intP t (i2+1)).
unfold is_min; intuition.
omega.
Save.

Proof.
intuition.
(* FILL PROOF HERE *)
Save.

Proof.
intuition.
(* FILL PROOF HERE *)
Save.

(* Why obligation from file "why/average.why", characters 1119-1147 *)
Lemma min_impl_po_3 : 
  forall (t: pointer),
  forall (n: Z),
  forall (alloc: alloc_table),
  forall (intP: ((memory) Z)),
  forall (Pre10: n > 0 /\ (valid_range alloc t 0 n)),
  forall (Pre9: (valid alloc (shift t 0))),
  forall (tmp: Z),
  forall (Post8: tmp = (acc intP (shift t 0))),
  forall (i1: Z),
  forall (Post1: i1 = 1),
  forall (Variant1: Z),
  forall (i2: Z),
  forall (tmp1: Z),
  forall (Pre7: Variant1 = (n - i2)),
  forall (Pre6: (1 <= i2 /\ i2 <= n) /\ (is_min alloc intP t i2 tmp1)),
  forall (Test4: i2 < n),
  forall (Pre5: (valid alloc (shift t i2))),
  forall (Test3: (acc intP (shift t i2)) < tmp1),
  forall (aux_3: pointer),
  forall (Post16: aux_3 = (shift t i2)),
  (valid alloc aux_3).
Proof.
intuition.
(* FILL PROOF HERE *)
Save.

(* Why obligation from file "why/average.why", characters 1119-1147 *)
Lemma min_impl_po_4 : 
  forall (t: pointer),
  forall (n: Z),
  forall (alloc: alloc_table),
  forall (intP: ((memory) Z)),
  forall (Pre10: n > 0 /\ (valid_range alloc t 0 n)),
  forall (Pre9: (valid alloc (shift t 0))),
  forall (tmp: Z),
  forall (Post8: tmp = (acc intP (shift t 0))),
  forall (i1: Z),
  forall (Post1: i1 = 1),
  forall (Variant1: Z),
  forall (i2: Z),
  forall (tmp1: Z),
  forall (Pre7: Variant1 = (n - i2)),
  forall (Pre6: (1 <= i2 /\ i2 <= n) /\ (is_min alloc intP t i2 tmp1)),
  forall (Test4: i2 < n),
  forall (Pre5: (valid alloc (shift t i2))),
  forall (Test3: (acc intP (shift t i2)) < tmp1),
  forall (aux_3: pointer),
  forall (Post16: aux_3 = (shift t i2)),
  forall (Pre2: (valid alloc aux_3)),
  forall (result2: Z),
  forall (Post18: result2 = (acc intP aux_3)),
  result2 = (acc intP (shift t i2)).
Proof.
intuition.
(* FILL PROOF HERE *)
Save.

(* Why obligation from file "why/average.why", characters 1112-1147 *)
Lemma min_impl_po_5 : 
  forall (t: pointer),
  forall (n: Z),
  forall (alloc: alloc_table),
  forall (intP: ((memory) Z)),
  forall (Pre10: n > 0 /\ (valid_range alloc t 0 n)),
  forall (Pre9: (valid alloc (shift t 0))),
  forall (tmp: Z),
  forall (Post8: tmp = (acc intP (shift t 0))),
  forall (i1: Z),
  forall (Post1: i1 = 1),
  forall (Variant1: Z),
  forall (i2: Z),
  forall (tmp1: Z),
  forall (Pre7: Variant1 = (n - i2)),
  forall (Pre6: (1 <= i2 /\ i2 <= n) /\ (is_min alloc intP t i2 tmp1)),
  forall (Test4: i2 < n),
  forall (Pre5: (valid alloc (shift t i2))),
  forall (Test3: (acc intP (shift t i2)) < tmp1),
  forall (tmp2: Z),
  forall (Post4: tmp2 = (acc intP (shift t i2))),
  (forall (i:Z),
   (i = (i2 + 1) -> ((1 <= i /\ i <= n) /\ (is_min alloc intP t i tmp2)) /\
    (Zwf 0 (n - i) (n - i2)))).
Proof.
intuition.
(* FILL PROOF HERE *)
Save.

(* Why obligation from file "why/average.why", characters 1160-1160 *)
Lemma min_impl_po_6 : 
  forall (t: pointer),
  forall (n: Z),
  forall (alloc: alloc_table),
  forall (intP: ((memory) Z)),
  forall (Pre10: n > 0 /\ (valid_range alloc t 0 n)),
  forall (Pre9: (valid alloc (shift t 0))),
  forall (tmp: Z),
  forall (Post8: tmp = (acc intP (shift t 0))),
  forall (i1: Z),
  forall (Post1: i1 = 1),
  forall (Variant1: Z),
  forall (i2: Z),
  forall (tmp1: Z),
  forall (Pre7: Variant1 = (n - i2)),
  forall (Pre6: (1 <= i2 /\ i2 <= n) /\ (is_min alloc intP t i2 tmp1)),
  forall (Test4: i2 < n),
  forall (Pre5: (valid alloc (shift t i2))),
  forall (Test2: (acc intP (shift t i2)) >= tmp1),
  forall (result2: unit),
  forall (Post3: result2 = tt),
  (forall (i:Z),
   (i = (i2 + 1) -> ((1 <= i /\ i <= n) /\ (is_min alloc intP t i tmp1)) /\
    (Zwf 0 (n - i) (n - i2)))).
Proof.
intuition.
(* FILL PROOF HERE *)
Save.

(* Why obligation from file "why/average.why", characters 855-1199 *)
Lemma min_impl_po_7 : 
  forall (t: pointer),
  forall (n: Z),
  forall (alloc: alloc_table),
  forall (intP: ((memory) Z)),
  forall (Pre10: n > 0 /\ (valid_range alloc t 0 n)),
  forall (Pre9: (valid alloc (shift t 0))),
  forall (tmp: Z),
  forall (Post8: tmp = (acc intP (shift t 0))),
  forall (i1: Z),
  forall (Post1: i1 = 1),
  forall (Variant1: Z),
  forall (i2: Z),
  forall (tmp1: Z),
  forall (Pre7: Variant1 = (n - i2)),
  forall (Pre6: (1 <= i2 /\ i2 <= n) /\ (is_min alloc intP t i2 tmp1)),
  forall (Test1: i2 >= n),
  (forall (result:Z), (result = tmp1 -> (is_min alloc intP t n result))).
Proof.
intuition.
(* FILL PROOF HERE *)
Save.

(* Why obligation from file "why/average.why", characters 906-973 *)
Lemma min_impl_po_8 : 
  forall (t: pointer),
  forall (n: Z),
  forall (alloc: alloc_table),
  forall (intP: ((memory) Z)),
  forall (Pre10: n > 0 /\ (valid_range alloc t 0 n)),
  forall (Pre9: (valid alloc (shift t 0))),
  forall (tmp: Z),
  forall (Post8: tmp = (acc intP (shift t 0))),
  forall (i1: Z),
  forall (Post1: i1 = 1),
  (1 <= i1 /\ i1 <= n) /\ (is_min alloc intP t i1 tmp).
Proof.
intuition.
(* FILL PROOF HERE *)
Save.


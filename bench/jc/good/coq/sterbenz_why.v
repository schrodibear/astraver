(* This file was originally generated by why.
   It can be modified; only the generated parts will be overwritten. *)

Require Export jessie_why.
(*Require Export WhyFloatsFull.*)
Require Export Reals.
Require Import tactics. (* tactique interval *)
(*Require Export w2g.*) 
Require Export wfull2g.


Require Export WhyFloats.


Inductive float_format : Set :=  Single | Double.

Definition bfloat_format (f : float_format) :=
match f with 
| Single => bsingle
| Double => bdouble
end.

Definition precision (f : float_format) :=
match f with 
| Single => 24%nat
| Double => 53%nat
end.

Definition max_gen_float (f : float_format) :=
match f with 
| Single => ((2-powerRZ radix (-23))*powerRZ radix 127)%R
| Double => ((2-powerRZ radix (-52))*powerRZ radix 1023)%R
end.

Definition plus_infinity_gen_float (f : float_format) :=
match f with 
| Single => (powerRZ radix 128)%R
| Double => (powerRZ radix 1024)%R
end.



(* generic floats*)

Record gen_float : Set := mk_gen_float {
   genf         : float;
   exact_value : R;
   model_value : R
 }.

(*
Hcangenf     : Fcanonic radix (bfloat_format f) genf;
*)


Definition float_value (x:gen_float) := FtoRradix (genf x).

Definition gen_round_error (x:gen_float) := 
    (Rabs ((exact_value x) - (float_value x))).

Definition gen_total_error (x:gen_float):= 
    (Rabs ((model_value x) - (float_value x))).


Definition gen_set_model (x:gen_float) (r:R) :=
      mk_gen_float (genf x) (exact_value x) r.


Definition  gen_float_of_real_aux (f:float_format) (m:mode) (r r1 r2:R) := 
match m with
  |  nearest_even => mk_gen_float (RND_EvenClosest (bfloat_format f) radix (precision f) r) 
                                 r1 r2
  |  to_zero          => mk_gen_float (RND_Zero (bfloat_format f) radix (precision f) r) 
                                 r1 r2
  |  up                  => mk_gen_float (RND_Min (bfloat_format f) radix (precision f) r) 
                                 r1 r2
  |  down             => mk_gen_float (RND_Max (bfloat_format f) radix (precision f) r) 
				r1 r2
  |  nearest_away => mk_gen_float (RND_ClosestUp (bfloat_format f) radix (precision f) r) 
				r1 r2
  end.

   
Definition gen_float_of_real (f:float_format) (m:mode) (r:R) := gen_float_of_real_aux f m r r r.
   

Definition round_float (f:float_format) (m:mode) (r:R) := FtoRradix (genf (gen_float_of_real f m r)).









Proof.
split;interval.
Save.

split;interval.
Save.




Proof.
(*w2g.
intros.
subst.
w2g.
apply Rle_antisym.
apply Rminus_le.
gappa.
assert (f <=f1 - f0 <= f)%R.
split.
apply Rminus_le.*)
Admitted.



Proof.
intuition.
Admitted.

Proof.
intuition.
Admitted.


Proof.
(*w2g.
intros.
assert (7 <= df why__return <= 7)%R.
subst.
w2g.
gappa.
(*
change (float2R (rounding_float roundNE 53 1074 (2 * (35 / 10))))
with (gappa_rounding (rounding_float roundNE 53 1074) (2 * (35/10))).
gappa.*)
destruct H.
now apply Rle_antisym.
*)
Admitted.

Proof.
intuition.
Admitted.

Proof.
intuition.
Admitted.

(* Why obligation from file "why/sterbenz.why", line 21, characters 57-102: *)
(*Why goal*) Lemma test1bis_ensures_default_po_1 : 
  forall (HW_1: (* JC_4 *) True),
  (Rle (Rabs (round_float Double nearest_even (2)%R)) (max_gen_float Double)).
Proof.
intuition.
Admitted.

(* Why obligation from file "why/sterbenz.why", line 22, characters 18-63: *)
(*Why goal*) Lemma test1bis_ensures_default_po_2 : 
  forall (HW_1: (* JC_4 *) True),
  forall (HW_2: (Rle (Rabs (round_float Double nearest_even (2)%R))
                 (max_gen_float Double))),
  forall (result: gen_float),
  forall (HW_3: (eq (float_value result) (round_float
                                          Double nearest_even (2)%R)) /\
                (eq (exact_value result) (2)%R) /\
                (eq (model_value result) (2)%R)),
  (Rle (Rabs (round_float Double nearest_even (35 / 10)%R))
   (max_gen_float Double)).
Proof.
intuition.
Admitted.

(* Why obligation from file "/users/demons/ayad/ppc/why/bench/jc/good/sterbenz.jc", line 17, characters 9-42: *)
(*Why goal*) Lemma test1bis_ensures_default_po_3 : 
  forall (HW_1: (* JC_4 *) True),
  forall (HW_2: (Rle (Rabs (round_float Double nearest_even (2)%R))
                 (max_gen_float Double))),
  forall (result: gen_float),
  forall (HW_3: (eq (float_value result) (round_float
                                          Double nearest_even (2)%R)) /\
                (eq (exact_value result) (2)%R) /\
                (eq (model_value result) (2)%R)),
  forall (HW_4: (Rle (Rabs (round_float Double nearest_even (35 / 10)%R))
                 (max_gen_float Double))),
  forall (result0: gen_float),
  forall (HW_5: (eq (float_value result0) (round_float
                                           Double nearest_even (35 / 10)%R)) /\
                (eq (exact_value result0) (35 / 10)%R) /\
                (eq (model_value result0) (35 / 10)%R)),
  (Rle
   (Rabs
    (round_float
     Double nearest_even (Rmult (float_value result) (float_value result0))))
   (max_gen_float Double)).
Proof.
intuition.
Admitted.

(* Why obligation from file "/users/demons/ayad/ppc/why/bench/jc/good/sterbenz.jc", line 15, characters 11-35: *)
(*Why goal*) Lemma test1bis_ensures_default_po_4 : 
  forall (HW_1: (* JC_4 *) True),
  forall (HW_2: (Rle (Rabs (round_float Double nearest_even (2)%R))
                 (max_gen_float Double))),
  forall (result: gen_float),
  forall (HW_3: (eq (float_value result) (round_float
                                          Double nearest_even (2)%R)) /\
                (eq (exact_value result) (2)%R) /\
                (eq (model_value result) (2)%R)),
  forall (HW_4: (Rle (Rabs (round_float Double nearest_even (35 / 10)%R))
                 (max_gen_float Double))),
  forall (result0: gen_float),
  forall (HW_5: (eq (float_value result0) (round_float
                                           Double nearest_even (35 / 10)%R)) /\
                (eq (exact_value result0) (35 / 10)%R) /\
                (eq (model_value result0) (35 / 10)%R)),
  forall (HW_6: (Rle
                 (Rabs
                  (round_float
                   Double nearest_even (Rmult
                                        (float_value result) (float_value
                                                              result0))))
                 (max_gen_float Double))),
  forall (result1: gen_float),
  forall (HW_7: (eq (float_value result1) (round_float
                                           Double nearest_even (Rmult
                                                                (float_value
                                                                 result) (
                                                                float_value
                                                                result0)))) /\
                (eq (exact_value result1) (Rmult
                                           (exact_value result) (exact_value
                                                                 result0))) /\
                (eq (model_value result1) (Rmult
                                           (model_value result) (model_value
                                                                 result0)))),
  forall (why__return: gen_float),
  forall (HW_8: why__return = result1),
  (* JC_5 *) (eq (float_value why__return) (7)%R).
Proof.
intuition.
Admitted.

(* Why obligation from file "why/sterbenz.why", line 39, characters 57-102: *)
(*Why goal*) Lemma test1bis_safety_po_1 : 
  forall (HW_1: (* JC_4 *) True),
  (Rle (Rabs (round_float Double nearest_even (2)%R)) (max_gen_float Double)).
Proof.
intuition.
Admitted.

(* Why obligation from file "why/sterbenz.why", line 40, characters 18-63: *)
(*Why goal*) Lemma test1bis_safety_po_2 : 
  forall (HW_1: (* JC_4 *) True),
  forall (HW_2: (Rle (Rabs (round_float Double nearest_even (2)%R))
                 (max_gen_float Double))),
  forall (result: gen_float),
  forall (HW_3: (eq (float_value result) (round_float
                                          Double nearest_even (2)%R)) /\
                (eq (exact_value result) (2)%R) /\
                (eq (model_value result) (2)%R)),
  (Rle (Rabs (round_float Double nearest_even (35 / 10)%R))
   (max_gen_float Double)).
Proof.
intuition.
Admitted.

(* Why obligation from file "/users/demons/ayad/ppc/why/bench/jc/good/sterbenz.jc", line 17, characters 9-42: *)
(*Why goal*) Lemma test1bis_safety_po_3 : 
  forall (HW_1: (* JC_4 *) True),
  forall (HW_2: (Rle (Rabs (round_float Double nearest_even (2)%R))
                 (max_gen_float Double))),
  forall (result: gen_float),
  forall (HW_3: (eq (float_value result) (round_float
                                          Double nearest_even (2)%R)) /\
                (eq (exact_value result) (2)%R) /\
                (eq (model_value result) (2)%R)),
  forall (HW_4: (Rle (Rabs (round_float Double nearest_even (35 / 10)%R))
                 (max_gen_float Double))),
  forall (result0: gen_float),
  forall (HW_5: (eq (float_value result0) (round_float
                                           Double nearest_even (35 / 10)%R)) /\
                (eq (exact_value result0) (35 / 10)%R) /\
                (eq (model_value result0) (35 / 10)%R)),
  (Rle
   (Rabs
    (round_float
     Double nearest_even (Rmult (float_value result) (float_value result0))))
   (max_gen_float Double)).
Proof.
intuition.
Admitted.

Proof.
intuition.
Admitted.

Proof.
intuition.
Admitted.

Proof.
intuition.
Admitted.


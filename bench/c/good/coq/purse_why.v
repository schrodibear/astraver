(* This file was originally generated by why.
   It can be modified; only the generated parts will be overwritten. *)

Require Export purse_spec_why.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma credit_impl_po_1 : 
  forall (A797:Set),
  forall (p: ((pointer) A797)),
  forall (s: Z),
  forall (alloc: alloc_table),
  forall (balance_p_15: ((memory) Z A797)),
  forall (HW_1: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_p_15 alloc p) /\ s >= 0)),
  (valid alloc p).
Proof.
unfold purse_inv; intuition.
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma credit_impl_po_2 : 
  forall (A798:Set),
  forall (p: ((pointer) A798)),
  forall (s: Z),
  forall (alloc: alloc_table),
  forall (balance_p_15: ((memory) Z A798)),
  forall (HW_1: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_p_15 alloc p) /\ s >= 0)),
  forall (HW_2: (valid alloc p)),
  forall (result: Z),
  forall (HW_3: result = (acc balance_p_15 p)),
  forall (HW_4: (valid alloc p)),
  forall (balance_p_15_0: ((memory) Z A798)),
  forall (HW_5: balance_p_15_0 = (upd balance_p_15 p (result + s))),
  (purse_inv balance_p_15_0 alloc p).
Proof.
unfold purse_inv; intuition.
subst; caduceus.
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma credit_impl_po_3 : 
  forall (A799:Set),
  forall (p: ((pointer) A799)),
  forall (s: Z),
  forall (alloc: alloc_table),
  forall (balance_p_15: ((memory) Z A799)),
  forall (HW_1: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_p_15 alloc p) /\ s >= 0)),
  forall (HW_2: (valid alloc p)),
  forall (result: Z),
  forall (HW_3: result = (acc balance_p_15 p)),
  forall (HW_4: (valid alloc p)),
  forall (balance_p_15_0: ((memory) Z A799)),
  forall (HW_5: balance_p_15_0 = (upd balance_p_15 p (result + s))),
  (acc balance_p_15_0 p) = ((acc balance_p_15 p) + s).
Proof.
intuition.
subst; caduceus.
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma credit_impl_po_4 : 
  forall (A800:Set),
  forall (p: ((pointer) A800)),
  forall (s: Z),
  forall (alloc: alloc_table),
  forall (balance_p_15: ((memory) Z A800)),
  forall (HW_1: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_p_15 alloc p) /\ s >= 0)),
  forall (HW_2: (valid alloc p)),
  forall (result: Z),
  forall (HW_3: result = (acc balance_p_15 p)),
  forall (HW_4: (valid alloc p)),
  forall (balance_p_15_0: ((memory) Z A800)),
  forall (HW_5: balance_p_15_0 = (upd balance_p_15 p (result + s))),
  (not_assigns alloc balance_p_15 balance_p_15_0 (pset_singleton p)).
Proof.
intuition.
(*
rewrite HW_5.
red.
red in H.
intuition.
rewrite acc_upd_eq;auto.
omega.
*)
(*
rewrite HW_5.
rewrite acc_upd_eq;auto.
*)
subst.
red;intros.
rewrite acc_upd_neq;auto.
assert (p0 <>p).
apply pset_singleton_elim;auto.
auto.
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma new_purse_impl_po_1 : 
  1 >= 1.
Proof.
intuition.
(* FILL PROOF HERE *)
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma new_purse_impl_po_2 : 
  forall (alloc: alloc_table),
  forall (balance_Z28: ((memory) Z Z28)),
  forall (HW_1: 1 >= 1),
  forall (result: ((pointer) Z28)),
  forall (alloc0: alloc_table),
  forall (HW_2: (valid alloc0 result) /\ (offset result) = 0 /\
                (block_length alloc0 result) = 1 /\
                (valid_range alloc0 result 0 (1 - 1)) /\
                (fresh alloc result) /\ (on_heap alloc0 result) /\
                (alloc_extends alloc alloc0)),
  forall (HW_3: (valid alloc0 result)),
  forall (balance_Z28_0: ((memory) Z Z28)),
  forall (HW_4: balance_Z28_0 = (upd balance_Z28 result 0)),
  (fresh alloc result).
Proof.
intuition.
(* FILL PROOF HERE *)
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma new_purse_impl_po_3 : 
  forall (alloc: alloc_table),
  forall (balance_Z28: ((memory) Z Z28)),
  forall (HW_1: 1 >= 1),
  forall (result: ((pointer) Z28)),
  forall (alloc0: alloc_table),
  forall (HW_2: (valid alloc0 result) /\ (offset result) = 0 /\
                (block_length alloc0 result) = 1 /\
                (valid_range alloc0 result 0 (1 - 1)) /\
                (fresh alloc result) /\ (on_heap alloc0 result) /\
                (alloc_extends alloc alloc0)),
  forall (HW_3: (valid alloc0 result)),
  forall (balance_Z28_0: ((memory) Z Z28)),
  forall (HW_4: balance_Z28_0 = (upd balance_Z28 result 0)),
  (purse_inv balance_Z28_0 alloc0 result).
Proof.
intuition.
(* FILL PROOF HERE *)
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma new_purse_impl_po_4 : 
  forall (alloc: alloc_table),
  forall (balance_Z28: ((memory) Z Z28)),
  forall (HW_1: 1 >= 1),
  forall (result: ((pointer) Z28)),
  forall (alloc0: alloc_table),
  forall (HW_2: (valid alloc0 result) /\ (offset result) = 0 /\
                (block_length alloc0 result) = 1 /\
                (valid_range alloc0 result 0 (1 - 1)) /\
                (fresh alloc result) /\ (on_heap alloc0 result) /\
                (alloc_extends alloc alloc0)),
  forall (HW_3: (valid alloc0 result)),
  forall (balance_Z28_0: ((memory) Z Z28)),
  forall (HW_4: balance_Z28_0 = (upd balance_Z28 result 0)),
  (acc balance_Z28_0 result) = 0.
Proof.
intuition.
(* FILL PROOF HERE *)
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma new_purse_impl_po_5 : 
  forall (alloc: alloc_table),
  forall (balance_Z28: ((memory) Z Z28)),
  forall (HW_1: 1 >= 1),
  forall (result: ((pointer) Z28)),
  forall (alloc0: alloc_table),
  forall (HW_2: (valid alloc0 result) /\ (offset result) = 0 /\
                (block_length alloc0 result) = 1 /\
                (valid_range alloc0 result 0 (1 - 1)) /\
                (fresh alloc result) /\ (on_heap alloc0 result) /\
                (alloc_extends alloc alloc0)),
  forall (HW_3: (valid alloc0 result)),
  forall (balance_Z28_0: ((memory) Z Z28)),
  forall (HW_4: balance_Z28_0 = (upd balance_Z28 result 0)),
  (not_assigns alloc balance_Z28 balance_Z28_0 pset_empty).
Proof.
intuition.
(* FILL PROOF HERE *)
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma new_purse_impl_po_6 : 
  forall (alloc: alloc_table),
  forall (balance_Z28: ((memory) Z Z28)),
  forall (HW_1: 1 >= 1),
  forall (result: ((pointer) Z28)),
  forall (alloc0: alloc_table),
  forall (HW_2: (valid alloc0 result) /\ (offset result) = 0 /\
                (block_length alloc0 result) = 1 /\
                (valid_range alloc0 result 0 (1 - 1)) /\
                (fresh alloc result) /\ (on_heap alloc0 result) /\
                (alloc_extends alloc alloc0)),
  forall (HW_3: (valid alloc0 result)),
  forall (balance_Z28_0: ((memory) Z Z28)),
  forall (HW_4: balance_Z28_0 = (upd balance_Z28 result 0)),
  (alloc_extends alloc alloc0).
Proof.
intuition.
(* FILL PROOF HERE *)
Save.

Proof.
intuition.
(* FILL PROOF HERE *)
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma test1_impl_po_1 : 
  forall (A801:Set),
  forall (p1: ((pointer) A801)),
  forall (p2: ((pointer) A801)),
  forall (alloc: alloc_table),
  forall (balance_p2_18: ((memory) Z A801)),
  forall (HW_1: (* File "purse.c", line 25, characters 14-56 *)
                (((purse_inv balance_p2_18 alloc p1) /\
                (purse_inv balance_p2_18 alloc p2)) /\ ~(p1 = p2))),
  (valid alloc p1).
Proof.
unfold purse_inv; intuition.
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma test1_impl_po_2 : 
  forall (A802:Set),
  forall (p1: ((pointer) A802)),
  forall (p2: ((pointer) A802)),
  forall (alloc: alloc_table),
  forall (balance_p2_18: ((memory) Z A802)),
  forall (HW_1: (* File "purse.c", line 25, characters 14-56 *)
                (((purse_inv balance_p2_18 alloc p1) /\
                (purse_inv balance_p2_18 alloc p2)) /\ ~(p1 = p2))),
  forall (HW_2: (valid alloc p1)),
  forall (balance_p2_18_0: ((memory) Z A802)),
  forall (HW_3: balance_p2_18_0 = (upd balance_p2_18 p1 0)),
  (purse_inv balance_p2_18_0 alloc p2).
Proof.
unfold purse_inv; intuition.
subst;caduceus.
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma test1_impl_po_3 : 
  forall (A803:Set),
  forall (p1: ((pointer) A803)),
  forall (p2: ((pointer) A803)),
  forall (alloc: alloc_table),
  forall (balance_p2_18: ((memory) Z A803)),
  forall (HW_1: (* File "purse.c", line 25, characters 14-56 *)
                (((purse_inv balance_p2_18 alloc p1) /\
                (purse_inv balance_p2_18 alloc p2)) /\ ~(p1 = p2))),
  forall (HW_2: (valid alloc p1)),
  forall (balance_p2_18_0: ((memory) Z A803)),
  forall (HW_3: balance_p2_18_0 = (upd balance_p2_18 p1 0)),
  100 >= 0.
Proof.
unfold purse_inv; intuition.
Save.


(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma test1_impl_po_4 : 
  forall (A804:Set),
  forall (p1: ((pointer) A804)),
  forall (p2: ((pointer) A804)),
  forall (alloc: alloc_table),
  forall (balance_p2_18: ((memory) Z A804)),
  forall (HW_1: (* File "purse.c", line 25, characters 14-56 *)
                (((purse_inv balance_p2_18 alloc p1) /\
                (purse_inv balance_p2_18 alloc p2)) /\ ~(p1 = p2))),
  forall (HW_2: (valid alloc p1)),
  forall (balance_p2_18_0: ((memory) Z A804)),
  forall (HW_3: balance_p2_18_0 = (upd balance_p2_18 p1 0)),
  forall (HW_4: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_p2_18_0 alloc p2) /\ 100 >= 0)),
  forall (balance_p2_18_1: ((memory) Z A804)),
  forall (HW_5: (* File "purse.c", line 10, characters 13-63 *)
                ((purse_inv balance_p2_18_1 alloc p2) /\
                (acc balance_p2_18_1 p2) = ((acc balance_p2_18_0 p2) + 100)) /\
                (not_assigns alloc balance_p2_18_0 balance_p2_18_1
                 (pset_singleton p2))),
  forall (HW_6: (valid alloc p1)),
  forall (result: Z),
  forall (HW_7: result = (acc balance_p2_18_1 p1)),
  (* File "purse.c", line 27, characters 13-25 *) result = 0.
Proof.
intuition.
  subst.
  rewrite H5; auto; caduceus.
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma test1_impl_po_5 : 
  forall (A805:Set),
  forall (p1: ((pointer) A805)),
  forall (p2: ((pointer) A805)),
  forall (alloc: alloc_table),
  forall (balance_p2_18: ((memory) Z A805)),
  forall (HW_1: (* File "purse.c", line 25, characters 14-56 *)
                (((purse_inv balance_p2_18 alloc p1) /\
                (purse_inv balance_p2_18 alloc p2)) /\ ~(p1 = p2))),
  forall (HW_2: (valid alloc p1)),
  forall (balance_p2_18_0: ((memory) Z A805)),
  forall (HW_3: balance_p2_18_0 = (upd balance_p2_18 p1 0)),
  forall (HW_4: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_p2_18_0 alloc p2) /\ 100 >= 0)),
  forall (balance_p2_18_1: ((memory) Z A805)),
  forall (HW_5: (* File "purse.c", line 10, characters 13-63 *)
                ((purse_inv balance_p2_18_1 alloc p2) /\
                (acc balance_p2_18_1 p2) = ((acc balance_p2_18_0 p2) + 100)) /\
                (not_assigns alloc balance_p2_18_0 balance_p2_18_1
                 (pset_singleton p2))),
  forall (HW_6: (valid alloc p1)),
  forall (result: Z),
  forall (HW_7: result = (acc balance_p2_18_1 p1)),
  (not_assigns alloc balance_p2_18 balance_p2_18_1
   (pset_union (pset_singleton p2) (pset_singleton p1))).
Proof.
intuition.
red;intros.
rewrite H5; auto.
  subst.
  assert (p<>p1).
    generalize (pset_union_elim2 H8);intro.
    apply pset_singleton_elim;auto.
  caduceus.
generalize (pset_union_elim1 H8);auto.
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma test2_impl_po_1 : 
  forall (alloc: alloc_table),
  forall (balance_Z28: ((memory) Z Z28)),
  forall (result: ((pointer) Z28)),
  forall (alloc0: alloc_table),
  forall (balance_Z28_0: ((memory) Z Z28)),
  forall (HW_1: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc result) /\
                (purse_inv balance_Z28_0 alloc0 result)) /\
                (acc balance_Z28_0 result) = 0) /\
                (not_assigns alloc balance_Z28 balance_Z28_0 pset_empty) /\
                (alloc_extends alloc alloc0)),
  forall (result0: ((pointer) Z28)),
  forall (alloc1: alloc_table),
  forall (balance_Z28_1: ((memory) Z Z28)),
  forall (HW_2: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc0 result0) /\
                (purse_inv balance_Z28_1 alloc1 result0)) /\
                (acc balance_Z28_1 result0) = 0) /\
                (not_assigns alloc0 balance_Z28_0 balance_Z28_1 pset_empty) /\
                (alloc_extends alloc0 alloc1)),
  (purse_inv balance_Z28_1 alloc1 result).
Proof.
intuition.
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma test2_impl_po_2 : 
  forall (alloc: alloc_table),
  forall (balance_Z28: ((memory) Z Z28)),
  forall (result: ((pointer) Z28)),
  forall (alloc0: alloc_table),
  forall (balance_Z28_0: ((memory) Z Z28)),
  forall (HW_1: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc result) /\
                (purse_inv balance_Z28_0 alloc0 result)) /\
                (acc balance_Z28_0 result) = 0) /\
                (not_assigns alloc balance_Z28 balance_Z28_0 pset_empty) /\
                (alloc_extends alloc alloc0)),
  forall (result0: ((pointer) Z28)),
  forall (alloc1: alloc_table),
  forall (balance_Z28_1: ((memory) Z Z28)),
  forall (HW_2: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc0 result0) /\
                (purse_inv balance_Z28_1 alloc1 result0)) /\
                (acc balance_Z28_1 result0) = 0) /\
                (not_assigns alloc0 balance_Z28_0 balance_Z28_1 pset_empty) /\
                (alloc_extends alloc0 alloc1)),
  100 >= 0.
Proof.
unfold purse_inv; intuition.
(*
rewrite H11;auto.
apply pset_singleton_intro.
intro;subst.
rewrite <- shift_zero in H8.
generalize (fresh_not_valid H7 H8).
auto.
*)
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma test2_impl_po_3 : 
  forall (alloc: alloc_table),
  forall (balance_Z28: ((memory) Z Z28)),
  forall (result: ((pointer) Z28)),
  forall (alloc0: alloc_table),
  forall (balance_Z28_0: ((memory) Z Z28)),
  forall (HW_1: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc result) /\
                (purse_inv balance_Z28_0 alloc0 result)) /\
                (acc balance_Z28_0 result) = 0) /\
                (not_assigns alloc balance_Z28 balance_Z28_0 pset_empty) /\
                (alloc_extends alloc alloc0)),
  forall (result0: ((pointer) Z28)),
  forall (alloc1: alloc_table),
  forall (balance_Z28_1: ((memory) Z Z28)),
  forall (HW_2: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc0 result0) /\
                (purse_inv balance_Z28_1 alloc1 result0)) /\
                (acc balance_Z28_1 result0) = 0) /\
                (not_assigns alloc0 balance_Z28_0 balance_Z28_1 pset_empty) /\
                (alloc_extends alloc0 alloc1)),
  forall (HW_3: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_Z28_1 alloc1 result) /\ 100 >= 0)),
  forall (balance_Z28_2: ((memory) Z Z28)),
  forall (HW_4: (* File "purse.c", line 10, characters 13-63 *)
                ((purse_inv balance_Z28_2 alloc1 result) /\
                (acc balance_Z28_2 result) =
                ((acc balance_Z28_1 result) + 100)) /\
                (not_assigns alloc1 balance_Z28_1 balance_Z28_2
                 (pset_singleton result))),
  (purse_inv balance_Z28_2 alloc1 result0).
Proof.
unfold purse_inv; intuition.
(*
rewrite H18;intuition.
apply pset_singleton_intro; auto.
intro;subst.
rewrite <- shift_zero in H14.
generalize (fresh_not_valid H1 H14).
auto.
rewrite H18;intuition.
apply pset_singleton_intro; auto.
intro;subst.
rewrite <- shift_zero in H.
generalize (fresh_not_valid H1 H);tauto.
*)
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma test2_impl_po_4 : 
  forall (alloc: alloc_table),
  forall (balance_Z28: ((memory) Z Z28)),
  forall (result: ((pointer) Z28)),
  forall (alloc0: alloc_table),
  forall (balance_Z28_0: ((memory) Z Z28)),
  forall (HW_1: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc result) /\
                (purse_inv balance_Z28_0 alloc0 result)) /\
                (acc balance_Z28_0 result) = 0) /\
                (not_assigns alloc balance_Z28 balance_Z28_0 pset_empty) /\
                (alloc_extends alloc alloc0)),
  forall (result0: ((pointer) Z28)),
  forall (alloc1: alloc_table),
  forall (balance_Z28_1: ((memory) Z Z28)),
  forall (HW_2: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc0 result0) /\
                (purse_inv balance_Z28_1 alloc1 result0)) /\
                (acc balance_Z28_1 result0) = 0) /\
                (not_assigns alloc0 balance_Z28_0 balance_Z28_1 pset_empty) /\
                (alloc_extends alloc0 alloc1)),
  forall (HW_3: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_Z28_1 alloc1 result) /\ 100 >= 0)),
  forall (balance_Z28_2: ((memory) Z Z28)),
  forall (HW_4: (* File "purse.c", line 10, characters 13-63 *)
                ((purse_inv balance_Z28_2 alloc1 result) /\
                (acc balance_Z28_2 result) =
                ((acc balance_Z28_1 result) + 100)) /\
                (not_assigns alloc1 balance_Z28_1 balance_Z28_2
                 (pset_singleton result))),
  200 >= 0.
Proof.
unfold purse_inv; intuition.
(*
rewrite H26;intuition.
apply pset_singleton_intro; auto.
intro;subst.
rewrite <- shift_zero in H5.
generalize (fresh_not_valid H1 H5);tauto.
assert (not_in_pset result0 (pset_singleton result)).
apply pset_singleton_intro.
intro;subst.
rewrite <- shift_zero in H20. 
generalize (fresh_not_valid H1 H20);tauto.
rewrite H26;intuition.
*)
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma test2_impl_po_5 : 
  forall (alloc: alloc_table),
  forall (balance_Z28: ((memory) Z Z28)),
  forall (result: ((pointer) Z28)),
  forall (alloc0: alloc_table),
  forall (balance_Z28_0: ((memory) Z Z28)),
  forall (HW_1: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc result) /\
                (purse_inv balance_Z28_0 alloc0 result)) /\
                (acc balance_Z28_0 result) = 0) /\
                (not_assigns alloc balance_Z28 balance_Z28_0 pset_empty) /\
                (alloc_extends alloc alloc0)),
  forall (result0: ((pointer) Z28)),
  forall (alloc1: alloc_table),
  forall (balance_Z28_1: ((memory) Z Z28)),
  forall (HW_2: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc0 result0) /\
                (purse_inv balance_Z28_1 alloc1 result0)) /\
                (acc balance_Z28_1 result0) = 0) /\
                (not_assigns alloc0 balance_Z28_0 balance_Z28_1 pset_empty) /\
                (alloc_extends alloc0 alloc1)),
  forall (HW_3: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_Z28_1 alloc1 result) /\ 100 >= 0)),
  forall (balance_Z28_2: ((memory) Z Z28)),
  forall (HW_4: (* File "purse.c", line 10, characters 13-63 *)
                ((purse_inv balance_Z28_2 alloc1 result) /\
                (acc balance_Z28_2 result) =
                ((acc balance_Z28_1 result) + 100)) /\
                (not_assigns alloc1 balance_Z28_1 balance_Z28_2
                 (pset_singleton result))),
  forall (HW_5: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_Z28_2 alloc1 result0) /\ 200 >= 0)),
  forall (balance_Z28_3: ((memory) Z Z28)),
  forall (HW_6: (* File "purse.c", line 10, characters 13-63 *)
                ((purse_inv balance_Z28_3 alloc1 result0) /\
                (acc balance_Z28_3 result0) =
                ((acc balance_Z28_2 result0) + 200)) /\
                (not_assigns alloc1 balance_Z28_2 balance_Z28_3
                 (pset_singleton result0))),
  (purse_inv balance_Z28_3 alloc1 result).
Proof.
intuition.
(*
generalize (fresh_not_valid H1 ).
intro.
generalize (H21 0).
rewrite shift_zero.
*)
Admitted.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma test2_impl_po_6 : 
  forall (alloc: alloc_table),
  forall (balance_Z28: ((memory) Z Z28)),
  forall (result: ((pointer) Z28)),
  forall (alloc0: alloc_table),
  forall (balance_Z28_0: ((memory) Z Z28)),
  forall (HW_1: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc result) /\
                (purse_inv balance_Z28_0 alloc0 result)) /\
                (acc balance_Z28_0 result) = 0) /\
                (not_assigns alloc balance_Z28 balance_Z28_0 pset_empty) /\
                (alloc_extends alloc alloc0)),
  forall (result0: ((pointer) Z28)),
  forall (alloc1: alloc_table),
  forall (balance_Z28_1: ((memory) Z Z28)),
  forall (HW_2: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc0 result0) /\
                (purse_inv balance_Z28_1 alloc1 result0)) /\
                (acc balance_Z28_1 result0) = 0) /\
                (not_assigns alloc0 balance_Z28_0 balance_Z28_1 pset_empty) /\
                (alloc_extends alloc0 alloc1)),
  forall (HW_3: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_Z28_1 alloc1 result) /\ 100 >= 0)),
  forall (balance_Z28_2: ((memory) Z Z28)),
  forall (HW_4: (* File "purse.c", line 10, characters 13-63 *)
                ((purse_inv balance_Z28_2 alloc1 result) /\
                (acc balance_Z28_2 result) =
                ((acc balance_Z28_1 result) + 100)) /\
                (not_assigns alloc1 balance_Z28_1 balance_Z28_2
                 (pset_singleton result))),
  forall (HW_5: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_Z28_2 alloc1 result0) /\ 200 >= 0)),
  forall (balance_Z28_3: ((memory) Z Z28)),
  forall (HW_6: (* File "purse.c", line 10, characters 13-63 *)
                ((purse_inv balance_Z28_3 alloc1 result0) /\
                (acc balance_Z28_3 result0) =
                ((acc balance_Z28_2 result0) + 200)) /\
                (not_assigns alloc1 balance_Z28_2 balance_Z28_3
                 (pset_singleton result0))),
  0 <= 50.
Proof.
unfold purse_inv; intuition.
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma test2_impl_po_7 : 
  forall (alloc: alloc_table),
  forall (balance_Z28: ((memory) Z Z28)),
  forall (result: ((pointer) Z28)),
  forall (alloc0: alloc_table),
  forall (balance_Z28_0: ((memory) Z Z28)),
  forall (HW_1: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc result) /\
                (purse_inv balance_Z28_0 alloc0 result)) /\
                (acc balance_Z28_0 result) = 0) /\
                (not_assigns alloc balance_Z28 balance_Z28_0 pset_empty) /\
                (alloc_extends alloc alloc0)),
  forall (result0: ((pointer) Z28)),
  forall (alloc1: alloc_table),
  forall (balance_Z28_1: ((memory) Z Z28)),
  forall (HW_2: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc0 result0) /\
                (purse_inv balance_Z28_1 alloc1 result0)) /\
                (acc balance_Z28_1 result0) = 0) /\
                (not_assigns alloc0 balance_Z28_0 balance_Z28_1 pset_empty) /\
                (alloc_extends alloc0 alloc1)),
  forall (HW_3: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_Z28_1 alloc1 result) /\ 100 >= 0)),
  forall (balance_Z28_2: ((memory) Z Z28)),
  forall (HW_4: (* File "purse.c", line 10, characters 13-63 *)
                ((purse_inv balance_Z28_2 alloc1 result) /\
                (acc balance_Z28_2 result) =
                ((acc balance_Z28_1 result) + 100)) /\
                (not_assigns alloc1 balance_Z28_1 balance_Z28_2
                 (pset_singleton result))),
  forall (HW_5: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_Z28_2 alloc1 result0) /\ 200 >= 0)),
  forall (balance_Z28_3: ((memory) Z Z28)),
  forall (HW_6: (* File "purse.c", line 10, characters 13-63 *)
                ((purse_inv balance_Z28_3 alloc1 result0) /\
                (acc balance_Z28_3 result0) =
                ((acc balance_Z28_2 result0) + 200)) /\
                (not_assigns alloc1 balance_Z28_2 balance_Z28_3
                 (pset_singleton result0))),
  50 <= (acc balance_Z28_3 result).
Proof.
intuition.
(*
subst .
assert (result<> result0).
intro;subst.
rewrite <- shift_zero in HW_11. 
generalize (fresh_not_valid H6 HW_11);tauto.
red in H7;intuition.
rewrite H27.
rewrite H25;intuition.
rewrite H23.
rewrite H19;intuition.
rewrite H17.
rewrite H13;intuition.
rewrite H12.
rewrite H8;intuition.
*)
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma test2_impl_po_8 : 
  forall (alloc: alloc_table),
  forall (balance_Z28: ((memory) Z Z28)),
  forall (result: ((pointer) Z28)),
  forall (alloc0: alloc_table),
  forall (balance_Z28_0: ((memory) Z Z28)),
  forall (HW_1: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc result) /\
                (purse_inv balance_Z28_0 alloc0 result)) /\
                (acc balance_Z28_0 result) = 0) /\
                (not_assigns alloc balance_Z28 balance_Z28_0 pset_empty) /\
                (alloc_extends alloc alloc0)),
  forall (result0: ((pointer) Z28)),
  forall (alloc1: alloc_table),
  forall (balance_Z28_1: ((memory) Z Z28)),
  forall (HW_2: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc0 result0) /\
                (purse_inv balance_Z28_1 alloc1 result0)) /\
                (acc balance_Z28_1 result0) = 0) /\
                (not_assigns alloc0 balance_Z28_0 balance_Z28_1 pset_empty) /\
                (alloc_extends alloc0 alloc1)),
  forall (HW_3: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_Z28_1 alloc1 result) /\ 100 >= 0)),
  forall (balance_Z28_2: ((memory) Z Z28)),
  forall (HW_4: (* File "purse.c", line 10, characters 13-63 *)
                ((purse_inv balance_Z28_2 alloc1 result) /\
                (acc balance_Z28_2 result) =
                ((acc balance_Z28_1 result) + 100)) /\
                (not_assigns alloc1 balance_Z28_1 balance_Z28_2
                 (pset_singleton result))),
  forall (HW_5: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_Z28_2 alloc1 result0) /\ 200 >= 0)),
  forall (balance_Z28_3: ((memory) Z Z28)),
  forall (HW_6: (* File "purse.c", line 10, characters 13-63 *)
                ((purse_inv balance_Z28_3 alloc1 result0) /\
                (acc balance_Z28_3 result0) =
                ((acc balance_Z28_2 result0) + 200)) /\
                (not_assigns alloc1 balance_Z28_2 balance_Z28_3
                 (pset_singleton result0))),
  forall (HW_7: (* File "purse.c", line 16, characters 14-50 *)
                ((purse_inv balance_Z28_3 alloc1 result) /\ 0 <= 50 /\ 50 <=
                (acc balance_Z28_3 result))),
  forall (balance_Z28_4: ((memory) Z Z28)),
  forall (HW_8: (* File "purse.c", line 18, characters 13-63 *)
                ((purse_inv balance_Z28_4 alloc1 result) /\
                (acc balance_Z28_4 result) =
                ((acc balance_Z28_3 result) - 50)) /\
                (not_assigns alloc1 balance_Z28_3 balance_Z28_4
                 (pset_singleton result))),
  (purse_inv balance_Z28_4 alloc1 result0).
Proof.
intuition.
(* FILL PROOF HERE *)
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma test2_impl_po_9 : 
  forall (alloc: alloc_table),
  forall (balance_Z28: ((memory) Z Z28)),
  forall (result: ((pointer) Z28)),
  forall (alloc0: alloc_table),
  forall (balance_Z28_0: ((memory) Z Z28)),
  forall (HW_1: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc result) /\
                (purse_inv balance_Z28_0 alloc0 result)) /\
                (acc balance_Z28_0 result) = 0) /\
                (not_assigns alloc balance_Z28 balance_Z28_0 pset_empty) /\
                (alloc_extends alloc alloc0)),
  forall (result0: ((pointer) Z28)),
  forall (alloc1: alloc_table),
  forall (balance_Z28_1: ((memory) Z Z28)),
  forall (HW_2: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc0 result0) /\
                (purse_inv balance_Z28_1 alloc1 result0)) /\
                (acc balance_Z28_1 result0) = 0) /\
                (not_assigns alloc0 balance_Z28_0 balance_Z28_1 pset_empty) /\
                (alloc_extends alloc0 alloc1)),
  forall (HW_3: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_Z28_1 alloc1 result) /\ 100 >= 0)),
  forall (balance_Z28_2: ((memory) Z Z28)),
  forall (HW_4: (* File "purse.c", line 10, characters 13-63 *)
                ((purse_inv balance_Z28_2 alloc1 result) /\
                (acc balance_Z28_2 result) =
                ((acc balance_Z28_1 result) + 100)) /\
                (not_assigns alloc1 balance_Z28_1 balance_Z28_2
                 (pset_singleton result))),
  forall (HW_5: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_Z28_2 alloc1 result0) /\ 200 >= 0)),
  forall (balance_Z28_3: ((memory) Z Z28)),
  forall (HW_6: (* File "purse.c", line 10, characters 13-63 *)
                ((purse_inv balance_Z28_3 alloc1 result0) /\
                (acc balance_Z28_3 result0) =
                ((acc balance_Z28_2 result0) + 200)) /\
                (not_assigns alloc1 balance_Z28_2 balance_Z28_3
                 (pset_singleton result0))),
  forall (HW_7: (* File "purse.c", line 16, characters 14-50 *)
                ((purse_inv balance_Z28_3 alloc1 result) /\ 0 <= 50 /\ 50 <=
                (acc balance_Z28_3 result))),
  forall (balance_Z28_4: ((memory) Z Z28)),
  forall (HW_8: (* File "purse.c", line 18, characters 13-63 *)
                ((purse_inv balance_Z28_4 alloc1 result) /\
                (acc balance_Z28_4 result) =
                ((acc balance_Z28_3 result) - 50)) /\
                (not_assigns alloc1 balance_Z28_3 balance_Z28_4
                 (pset_singleton result))),
  0 <= 100.
Proof.
intuition.
(* FILL PROOF HERE *)
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma test2_impl_po_10 : 
  forall (alloc: alloc_table),
  forall (balance_Z28: ((memory) Z Z28)),
  forall (result: ((pointer) Z28)),
  forall (alloc0: alloc_table),
  forall (balance_Z28_0: ((memory) Z Z28)),
  forall (HW_1: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc result) /\
                (purse_inv balance_Z28_0 alloc0 result)) /\
                (acc balance_Z28_0 result) = 0) /\
                (not_assigns alloc balance_Z28 balance_Z28_0 pset_empty) /\
                (alloc_extends alloc alloc0)),
  forall (result0: ((pointer) Z28)),
  forall (alloc1: alloc_table),
  forall (balance_Z28_1: ((memory) Z Z28)),
  forall (HW_2: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc0 result0) /\
                (purse_inv balance_Z28_1 alloc1 result0)) /\
                (acc balance_Z28_1 result0) = 0) /\
                (not_assigns alloc0 balance_Z28_0 balance_Z28_1 pset_empty) /\
                (alloc_extends alloc0 alloc1)),
  forall (HW_3: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_Z28_1 alloc1 result) /\ 100 >= 0)),
  forall (balance_Z28_2: ((memory) Z Z28)),
  forall (HW_4: (* File "purse.c", line 10, characters 13-63 *)
                ((purse_inv balance_Z28_2 alloc1 result) /\
                (acc balance_Z28_2 result) =
                ((acc balance_Z28_1 result) + 100)) /\
                (not_assigns alloc1 balance_Z28_1 balance_Z28_2
                 (pset_singleton result))),
  forall (HW_5: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_Z28_2 alloc1 result0) /\ 200 >= 0)),
  forall (balance_Z28_3: ((memory) Z Z28)),
  forall (HW_6: (* File "purse.c", line 10, characters 13-63 *)
                ((purse_inv balance_Z28_3 alloc1 result0) /\
                (acc balance_Z28_3 result0) =
                ((acc balance_Z28_2 result0) + 200)) /\
                (not_assigns alloc1 balance_Z28_2 balance_Z28_3
                 (pset_singleton result0))),
  forall (HW_7: (* File "purse.c", line 16, characters 14-50 *)
                ((purse_inv balance_Z28_3 alloc1 result) /\ 0 <= 50 /\ 50 <=
                (acc balance_Z28_3 result))),
  forall (balance_Z28_4: ((memory) Z Z28)),
  forall (HW_8: (* File "purse.c", line 18, characters 13-63 *)
                ((purse_inv balance_Z28_4 alloc1 result) /\
                (acc balance_Z28_4 result) =
                ((acc balance_Z28_3 result) - 50)) /\
                (not_assigns alloc1 balance_Z28_3 balance_Z28_4
                 (pset_singleton result))),
  100 <= (acc balance_Z28_4 result0).
Proof.
intuition.
(* FILL PROOF HERE *)
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma test2_impl_po_11 : 
  forall (alloc: alloc_table),
  forall (balance_Z28: ((memory) Z Z28)),
  forall (result: ((pointer) Z28)),
  forall (alloc0: alloc_table),
  forall (balance_Z28_0: ((memory) Z Z28)),
  forall (HW_1: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc result) /\
                (purse_inv balance_Z28_0 alloc0 result)) /\
                (acc balance_Z28_0 result) = 0) /\
                (not_assigns alloc balance_Z28 balance_Z28_0 pset_empty) /\
                (alloc_extends alloc alloc0)),
  forall (result0: ((pointer) Z28)),
  forall (alloc1: alloc_table),
  forall (balance_Z28_1: ((memory) Z Z28)),
  forall (HW_2: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc0 result0) /\
                (purse_inv balance_Z28_1 alloc1 result0)) /\
                (acc balance_Z28_1 result0) = 0) /\
                (not_assigns alloc0 balance_Z28_0 balance_Z28_1 pset_empty) /\
                (alloc_extends alloc0 alloc1)),
  forall (HW_3: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_Z28_1 alloc1 result) /\ 100 >= 0)),
  forall (balance_Z28_2: ((memory) Z Z28)),
  forall (HW_4: (* File "purse.c", line 10, characters 13-63 *)
                ((purse_inv balance_Z28_2 alloc1 result) /\
                (acc balance_Z28_2 result) =
                ((acc balance_Z28_1 result) + 100)) /\
                (not_assigns alloc1 balance_Z28_1 balance_Z28_2
                 (pset_singleton result))),
  forall (HW_5: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_Z28_2 alloc1 result0) /\ 200 >= 0)),
  forall (balance_Z28_3: ((memory) Z Z28)),
  forall (HW_6: (* File "purse.c", line 10, characters 13-63 *)
                ((purse_inv balance_Z28_3 alloc1 result0) /\
                (acc balance_Z28_3 result0) =
                ((acc balance_Z28_2 result0) + 200)) /\
                (not_assigns alloc1 balance_Z28_2 balance_Z28_3
                 (pset_singleton result0))),
  forall (HW_7: (* File "purse.c", line 16, characters 14-50 *)
                ((purse_inv balance_Z28_3 alloc1 result) /\ 0 <= 50 /\ 50 <=
                (acc balance_Z28_3 result))),
  forall (balance_Z28_4: ((memory) Z Z28)),
  forall (HW_8: (* File "purse.c", line 18, characters 13-63 *)
                ((purse_inv balance_Z28_4 alloc1 result) /\
                (acc balance_Z28_4 result) =
                ((acc balance_Z28_3 result) - 50)) /\
                (not_assigns alloc1 balance_Z28_3 balance_Z28_4
                 (pset_singleton result))),
  forall (HW_9: (* File "purse.c", line 16, characters 14-50 *)
                ((purse_inv balance_Z28_4 alloc1 result0) /\ 0 <= 100 /\
                100 <= (acc balance_Z28_4 result0))),
  forall (balance_Z28_5: ((memory) Z Z28)),
  forall (HW_10: (* File "purse.c", line 18, characters 13-63 *)
                 ((purse_inv balance_Z28_5 alloc1 result0) /\
                 (acc balance_Z28_5 result0) =
                 ((acc balance_Z28_4 result0) - 100)) /\
                 (not_assigns alloc1 balance_Z28_4 balance_Z28_5
                  (pset_singleton result0))),
  (valid alloc1 result).
Proof.
unfold purse_inv;intuition.
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma test2_impl_po_12 : 
  forall (alloc: alloc_table),
  forall (balance_Z28: ((memory) Z Z28)),
  forall (result: ((pointer) Z28)),
  forall (alloc0: alloc_table),
  forall (balance_Z28_0: ((memory) Z Z28)),
  forall (HW_1: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc result) /\
                (purse_inv balance_Z28_0 alloc0 result)) /\
                (acc balance_Z28_0 result) = 0) /\
                (not_assigns alloc balance_Z28 balance_Z28_0 pset_empty) /\
                (alloc_extends alloc alloc0)),
  forall (result0: ((pointer) Z28)),
  forall (alloc1: alloc_table),
  forall (balance_Z28_1: ((memory) Z Z28)),
  forall (HW_2: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc0 result0) /\
                (purse_inv balance_Z28_1 alloc1 result0)) /\
                (acc balance_Z28_1 result0) = 0) /\
                (not_assigns alloc0 balance_Z28_0 balance_Z28_1 pset_empty) /\
                (alloc_extends alloc0 alloc1)),
  forall (HW_3: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_Z28_1 alloc1 result) /\ 100 >= 0)),
  forall (balance_Z28_2: ((memory) Z Z28)),
  forall (HW_4: (* File "purse.c", line 10, characters 13-63 *)
                ((purse_inv balance_Z28_2 alloc1 result) /\
                (acc balance_Z28_2 result) =
                ((acc balance_Z28_1 result) + 100)) /\
                (not_assigns alloc1 balance_Z28_1 balance_Z28_2
                 (pset_singleton result))),
  forall (HW_5: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_Z28_2 alloc1 result0) /\ 200 >= 0)),
  forall (balance_Z28_3: ((memory) Z Z28)),
  forall (HW_6: (* File "purse.c", line 10, characters 13-63 *)
                ((purse_inv balance_Z28_3 alloc1 result0) /\
                (acc balance_Z28_3 result0) =
                ((acc balance_Z28_2 result0) + 200)) /\
                (not_assigns alloc1 balance_Z28_2 balance_Z28_3
                 (pset_singleton result0))),
  forall (HW_7: (* File "purse.c", line 16, characters 14-50 *)
                ((purse_inv balance_Z28_3 alloc1 result) /\ 0 <= 50 /\ 50 <=
                (acc balance_Z28_3 result))),
  forall (balance_Z28_4: ((memory) Z Z28)),
  forall (HW_8: (* File "purse.c", line 18, characters 13-63 *)
                ((purse_inv balance_Z28_4 alloc1 result) /\
                (acc balance_Z28_4 result) =
                ((acc balance_Z28_3 result) - 50)) /\
                (not_assigns alloc1 balance_Z28_3 balance_Z28_4
                 (pset_singleton result))),
  forall (HW_9: (* File "purse.c", line 16, characters 14-50 *)
                ((purse_inv balance_Z28_4 alloc1 result0) /\ 0 <= 100 /\
                100 <= (acc balance_Z28_4 result0))),
  forall (balance_Z28_5: ((memory) Z Z28)),
  forall (HW_10: (* File "purse.c", line 18, characters 13-63 *)
                 ((purse_inv balance_Z28_5 alloc1 result0) /\
                 (acc balance_Z28_5 result0) =
                 ((acc balance_Z28_4 result0) - 100)) /\
                 (not_assigns alloc1 balance_Z28_4 balance_Z28_5
                  (pset_singleton result0))),
  forall (HW_11: (valid alloc1 result)),
  forall (result1: Z),
  forall (HW_12: result1 = (acc balance_Z28_5 result)),
  (valid alloc1 result0).
Proof.
unfold purse_inv;intuition.
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma test2_impl_po_13 : 
  forall (alloc: alloc_table),
  forall (balance_Z28: ((memory) Z Z28)),
  forall (result: ((pointer) Z28)),
  forall (alloc0: alloc_table),
  forall (balance_Z28_0: ((memory) Z Z28)),
  forall (HW_1: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc result) /\
                (purse_inv balance_Z28_0 alloc0 result)) /\
                (acc balance_Z28_0 result) = 0) /\
                (not_assigns alloc balance_Z28 balance_Z28_0 pset_empty) /\
                (alloc_extends alloc alloc0)),
  forall (result0: ((pointer) Z28)),
  forall (alloc1: alloc_table),
  forall (balance_Z28_1: ((memory) Z Z28)),
  forall (HW_2: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc0 result0) /\
                (purse_inv balance_Z28_1 alloc1 result0)) /\
                (acc balance_Z28_1 result0) = 0) /\
                (not_assigns alloc0 balance_Z28_0 balance_Z28_1 pset_empty) /\
                (alloc_extends alloc0 alloc1)),
  forall (HW_3: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_Z28_1 alloc1 result) /\ 100 >= 0)),
  forall (balance_Z28_2: ((memory) Z Z28)),
  forall (HW_4: (* File "purse.c", line 10, characters 13-63 *)
                ((purse_inv balance_Z28_2 alloc1 result) /\
                (acc balance_Z28_2 result) =
                ((acc balance_Z28_1 result) + 100)) /\
                (not_assigns alloc1 balance_Z28_1 balance_Z28_2
                 (pset_singleton result))),
  forall (HW_5: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_Z28_2 alloc1 result0) /\ 200 >= 0)),
  forall (balance_Z28_3: ((memory) Z Z28)),
  forall (HW_6: (* File "purse.c", line 10, characters 13-63 *)
                ((purse_inv balance_Z28_3 alloc1 result0) /\
                (acc balance_Z28_3 result0) =
                ((acc balance_Z28_2 result0) + 200)) /\
                (not_assigns alloc1 balance_Z28_2 balance_Z28_3
                 (pset_singleton result0))),
  forall (HW_7: (* File "purse.c", line 16, characters 14-50 *)
                ((purse_inv balance_Z28_3 alloc1 result) /\ 0 <= 50 /\ 50 <=
                (acc balance_Z28_3 result))),
  forall (balance_Z28_4: ((memory) Z Z28)),
  forall (HW_8: (* File "purse.c", line 18, characters 13-63 *)
                ((purse_inv balance_Z28_4 alloc1 result) /\
                (acc balance_Z28_4 result) =
                ((acc balance_Z28_3 result) - 50)) /\
                (not_assigns alloc1 balance_Z28_3 balance_Z28_4
                 (pset_singleton result))),
  forall (HW_9: (* File "purse.c", line 16, characters 14-50 *)
                ((purse_inv balance_Z28_4 alloc1 result0) /\ 0 <= 100 /\
                100 <= (acc balance_Z28_4 result0))),
  forall (balance_Z28_5: ((memory) Z Z28)),
  forall (HW_10: (* File "purse.c", line 18, characters 13-63 *)
                 ((purse_inv balance_Z28_5 alloc1 result0) /\
                 (acc balance_Z28_5 result0) =
                 ((acc balance_Z28_4 result0) - 100)) /\
                 (not_assigns alloc1 balance_Z28_4 balance_Z28_5
                  (pset_singleton result0))),
  forall (HW_11: (valid alloc1 result)),
  forall (result1: Z),
  forall (HW_12: result1 = (acc balance_Z28_5 result)),
  forall (HW_13: (valid alloc1 result0)),
  forall (result2: Z),
  forall (HW_14: result2 = (acc balance_Z28_5 result0)),
  (* File "purse.c", line 44, characters 13-27 *) (result1 + result2) = 150.
Proof.
intuition.
Save.

Proof.
intuition.
(* FILL PROOF HERE *)
Save.

Proof.
intuition.
(* FILL PROOF HERE *)
Save.

Proof.
intuition.
(* FILL PROOF HERE *)
Save.

Proof.
intuition.
(* FILL PROOF HERE *)
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma test2_impl_po_14 : 
  forall (alloc: alloc_table),
  forall (balance_Z28: ((memory) Z Z28)),
  forall (result: ((pointer) Z28)),
  forall (alloc0: alloc_table),
  forall (balance_Z28_0: ((memory) Z Z28)),
  forall (HW_1: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc result) /\
                (purse_inv balance_Z28_0 alloc0 result)) /\
                (acc balance_Z28_0 result) = 0) /\
                (not_assigns alloc balance_Z28 balance_Z28_0 pset_empty) /\
                (alloc_extends alloc alloc0)),
  forall (result0: ((pointer) Z28)),
  forall (alloc1: alloc_table),
  forall (balance_Z28_1: ((memory) Z Z28)),
  forall (HW_2: (* File "purse.c", line 36, characters 13-75 *)
                (((fresh alloc0 result0) /\
                (purse_inv balance_Z28_1 alloc1 result0)) /\
                (acc balance_Z28_1 result0) = 0) /\
                (not_assigns alloc0 balance_Z28_0 balance_Z28_1 pset_empty) /\
                (alloc_extends alloc0 alloc1)),
  forall (HW_3: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_Z28_1 alloc1 result) /\ 100 >= 0)),
  forall (balance_Z28_2: ((memory) Z Z28)),
  forall (HW_4: (* File "purse.c", line 10, characters 13-63 *)
                ((purse_inv balance_Z28_2 alloc1 result) /\
                (acc balance_Z28_2 result) =
                ((acc balance_Z28_1 result) + 100)) /\
                (not_assigns alloc1 balance_Z28_1 balance_Z28_2
                 (pset_singleton result))),
  forall (HW_5: (* File "purse.c", line 8, characters 14-36 *)
                ((purse_inv balance_Z28_2 alloc1 result0) /\ 200 >= 0)),
  forall (balance_Z28_3: ((memory) Z Z28)),
  forall (HW_6: (* File "purse.c", line 10, characters 13-63 *)
                ((purse_inv balance_Z28_3 alloc1 result0) /\
                (acc balance_Z28_3 result0) =
                ((acc balance_Z28_2 result0) + 200)) /\
                (not_assigns alloc1 balance_Z28_2 balance_Z28_3
                 (pset_singleton result0))),
  forall (HW_7: (* File "purse.c", line 16, characters 14-50 *)
                ((purse_inv balance_Z28_3 alloc1 result) /\ 0 <= 50 /\ 50 <=
                (acc balance_Z28_3 result))),
  forall (balance_Z28_4: ((memory) Z Z28)),
  forall (HW_8: (* File "purse.c", line 18, characters 13-63 *)
                ((purse_inv balance_Z28_4 alloc1 result) /\
                (acc balance_Z28_4 result) =
                ((acc balance_Z28_3 result) - 50)) /\
                (not_assigns alloc1 balance_Z28_3 balance_Z28_4
                 (pset_singleton result))),
  forall (HW_9: (* File "purse.c", line 16, characters 14-50 *)
                ((purse_inv balance_Z28_4 alloc1 result0) /\ 0 <= 100 /\
                100 <= (acc balance_Z28_4 result0))),
  forall (balance_Z28_5: ((memory) Z Z28)),
  forall (HW_10: (* File "purse.c", line 18, characters 13-63 *)
                 ((purse_inv balance_Z28_5 alloc1 result0) /\
                 (acc balance_Z28_5 result0) =
                 ((acc balance_Z28_4 result0) - 100)) /\
                 (not_assigns alloc1 balance_Z28_4 balance_Z28_5
                  (pset_singleton result0))),
  forall (HW_11: (valid alloc1 result)),
  forall (result1: Z),
  forall (HW_12: result1 = (acc balance_Z28_5 result)),
  forall (HW_13: (valid alloc1 result0)),
  forall (result2: Z),
  forall (HW_14: result2 = (acc balance_Z28_5 result0)),
  (alloc_extends alloc alloc1).
Proof.
intuition.
(* FILL PROOF HERE *)
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma withdraw_impl_po_1 : 
  forall (A806:Set),
  forall (p: ((pointer) A806)),
  forall (s: Z),
  forall (alloc: alloc_table),
  forall (balance_p_16: ((memory) Z A806)),
  forall (HW_1: (* File "purse.c", line 16, characters 14-50 *)
                ((purse_inv balance_p_16 alloc p) /\ 0 <= s /\ s <=
                (acc balance_p_16 p))),
  (valid alloc p).
Proof.
unfold purse_inv; intuition.
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma withdraw_impl_po_2 : 
  forall (A807:Set),
  forall (p: ((pointer) A807)),
  forall (s: Z),
  forall (alloc: alloc_table),
  forall (balance_p_16: ((memory) Z A807)),
  forall (HW_1: (* File "purse.c", line 16, characters 14-50 *)
                ((purse_inv balance_p_16 alloc p) /\ 0 <= s /\ s <=
                (acc balance_p_16 p))),
  forall (HW_2: (valid alloc p)),
  forall (result: Z),
  forall (HW_3: result = (acc balance_p_16 p)),
  forall (HW_4: (valid alloc p)),
  forall (balance_p_16_0: ((memory) Z A807)),
  forall (HW_5: balance_p_16_0 = (upd balance_p_16 p (result - s))),
  (purse_inv balance_p_16_0 alloc p).
Proof.
unfold purse_inv; intuition.
    subst; caduceus.
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma withdraw_impl_po_3 : 
  forall (A808:Set),
  forall (p: ((pointer) A808)),
  forall (s: Z),
  forall (alloc: alloc_table),
  forall (balance_p_16: ((memory) Z A808)),
  forall (HW_1: (* File "purse.c", line 16, characters 14-50 *)
                ((purse_inv balance_p_16 alloc p) /\ 0 <= s /\ s <=
                (acc balance_p_16 p))),
  forall (HW_2: (valid alloc p)),
  forall (result: Z),
  forall (HW_3: result = (acc balance_p_16 p)),
  forall (HW_4: (valid alloc p)),
  forall (balance_p_16_0: ((memory) Z A808)),
  forall (HW_5: balance_p_16_0 = (upd balance_p_16 p (result - s))),
  (acc balance_p_16_0 p) = ((acc balance_p_16 p) - s).
Proof.
intuition.
  subst; caduceus.
Save.

(* Why obligation from file "", line 0, characters 0-0: *)
(*Why goal*) Lemma withdraw_impl_po_4 : 
  forall (A809:Set),
  forall (p: ((pointer) A809)),
  forall (s: Z),
  forall (alloc: alloc_table),
  forall (balance_p_16: ((memory) Z A809)),
  forall (HW_1: (* File "purse.c", line 16, characters 14-50 *)
                ((purse_inv balance_p_16 alloc p) /\ 0 <= s /\ s <=
                (acc balance_p_16 p))),
  forall (HW_2: (valid alloc p)),
  forall (result: Z),
  forall (HW_3: result = (acc balance_p_16 p)),
  forall (HW_4: (valid alloc p)),
  forall (balance_p_16_0: ((memory) Z A809)),
  forall (HW_5: balance_p_16_0 = (upd balance_p_16 p (result - s))),
  (not_assigns alloc balance_p_16 balance_p_16_0 (pset_singleton p)).
Proof.
intuition.
subst; red; intros.
rewrite acc_upd_neq;auto.
assert (p0<>p).
apply pset_singleton_elim;auto.
auto.
Save.


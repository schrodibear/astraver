(* This file was originally generated by why.
   It can be modified; only the generated parts will be overwritten. *)

Require Export purse_spec_why.
(* Add LoadPath "../../../../lib/coq". *)
Load caduceus_tactics.

(* Why obligation from file "why/purse.why", line 0, characters 0-0: *)
(*Why goal*) Lemma credit_impl_po_1 : 
  forall (p: pointer),
  forall (s: Z),
  forall (alloc: alloc_table),
  forall (balance: ((memory) Z)),
  forall (HW_1: (* File \"purse.c819618234.c1069824147.i\", line 0, characters 10-32 *)
                ((purse_inv balance alloc p) /\ s >= 0)),
  forall (result: Z),
  forall (HW_2: result = (acc balance p)),
  forall (balance0: ((memory) Z)),
  forall (HW_3: balance0 = (upd balance p (result + s))),
  (* File \"<built-in>\", line 0, characters 6-56 *)
  ((purse_inv balance0 alloc p) /\ (acc balance0 p) = ((acc balance p) + s)) /\
  (not_assigns alloc balance balance0 (pset_singleton p)).
Proof.
unfold purse_inv; intuition.
Save.

(* Why obligation from file "why/purse.why", line 0, characters 0-0: *)
(*Why goal*) Lemma credit_impl_po_2 : 
  forall (p: pointer),
  forall (s: Z),
  forall (alloc: alloc_table),
  forall (balance: ((memory) Z)),
  forall (HW_1: (* File \"purse.c819618234.c1069824147.i\", line 0, characters 10-32 *)
                ((purse_inv balance alloc p) /\ s >= 0)),
  forall (result: Z),
  forall (HW_2: result = (acc balance p)),
  (valid alloc p).
Proof.
unfold purse_inv; intuition.
subst; caduceus.
subst; caduceus.
Save.

(* Why obligation from file "why/purse.why", line 0, characters 0-0: *)
(*Why goal*) Lemma credit_impl_po_3 : 
  forall (p: pointer),
  forall (s: Z),
  forall (alloc: alloc_table),
  forall (balance: ((memory) Z)),
  forall (HW_1: (* File \"purse.c819618234.c1069824147.i\", line 0, characters 10-32 *)
                ((purse_inv balance alloc p) /\ s >= 0)),
  (valid alloc p).
Proof.
intuition.
(* FILL PROOF HERE *)
Save.

(* Why obligation from file "why/purse.why", line 0, characters 0-0: *)
(*Why goal*) Lemma test1_impl_po_1 : 
  forall (p1: pointer),
  forall (p2: pointer),
  forall (alloc: alloc_table),
  forall (balance: ((memory) Z)),
  forall (HW_1: (* File \"purse.c819618234.c1069824147.i\", line 0, characters 10-52 *)
                (((purse_inv balance alloc p1) /\
                (purse_inv balance alloc p2)) /\ ~(p1 = p2))),
  forall (balance0: ((memory) Z)),
  forall (HW_2: balance0 = (upd balance p1 0)),
  forall (balance1: ((memory) Z)),
  forall (HW_3: (* File \"<built-in>\", line 0, characters 6-56 *)
                ((purse_inv balance1 alloc p2) /\ (acc balance1 p2) =
                ((acc balance0 p2) + 100)) /\
                (not_assigns alloc balance0 balance1 (pset_singleton p2))),
  forall (result: Z),
  forall (HW_4: result = (acc balance1 p1)),
  (* File \"purse.c819618234.c\", line 0, characters 2-14 *) result = 0 /\
  (not_assigns alloc balance balance1
   (pset_union (pset_singleton p2) (pset_singleton p1))).
Proof.
unfold purse_inv; intuition.
Save.

(* Why obligation from file "why/purse.why", line 0, characters 0-0: *)
(*Why goal*) Lemma test1_impl_po_2 : 
  forall (p1: pointer),
  forall (p2: pointer),
  forall (alloc: alloc_table),
  forall (balance: ((memory) Z)),
  forall (HW_1: (* File \"purse.c819618234.c1069824147.i\", line 0, characters 10-52 *)
                (((purse_inv balance alloc p1) /\
                (purse_inv balance alloc p2)) /\ ~(p1 = p2))),
  forall (balance0: ((memory) Z)),
  forall (HW_2: balance0 = (upd balance p1 0)),
  forall (balance1: ((memory) Z)),
  forall (HW_3: (* File \"<built-in>\", line 0, characters 6-56 *)
                ((purse_inv balance1 alloc p2) /\ (acc balance1 p2) =
                ((acc balance0 p2) + 100)) /\
                (not_assigns alloc balance0 balance1 (pset_singleton p2))),
  (valid alloc p1).
Proof.
unfold purse_inv; intuition.
subst;caduceus.
Save.

(* Why obligation from file "why/purse.why", line 0, characters 0-0: *)
(*Why goal*) Lemma test1_impl_po_3 : 
  forall (p1: pointer),
  forall (p2: pointer),
  forall (alloc: alloc_table),
  forall (balance: ((memory) Z)),
  forall (HW_1: (* File \"purse.c819618234.c1069824147.i\", line 0, characters 10-52 *)
                (((purse_inv balance alloc p1) /\
                (purse_inv balance alloc p2)) /\ ~(p1 = p2))),
  forall (balance0: ((memory) Z)),
  forall (HW_2: balance0 = (upd balance p1 0)),
  (* File \"purse.c819618234.c1069824147.i\", line 0, characters 10-32 *)
  ((purse_inv balance0 alloc p2) /\ 100 >= 0).
Proof.
unfold purse_inv; intuition.
subst.
rewrite H8;caduceus;auto.
subst balance0; caduceus.
unfold not_assigns; intuition.
assert (p<>p2).
apply pset_singleton_elim.
apply pset_union_elim1 with (pset_singleton p1).
assumption.
rewrite H8; intuition.
subst.
assert (p<>p1).
apply pset_singleton_elim.
apply pset_union_elim2 with (pset_singleton p2).
assumption.
caduceus.
Save.


(* Why obligation from file "why/purse.why", line 0, characters 0-0: *)
(*Why goal*) Lemma test1_impl_po_4 : 
  forall (p1: pointer),
  forall (p2: pointer),
  forall (alloc: alloc_table),
  forall (balance: ((memory) Z)),
  forall (HW_1: (* File \"purse.c819618234.c1069824147.i\", line 0, characters 10-52 *)
                (((purse_inv balance alloc p1) /\
                (purse_inv balance alloc p2)) /\ ~(p1 = p2))),
  (valid alloc p1).
Proof.
intuition.
(* FILL PROOF HERE *)
Save.

(* Why obligation from file "why/purse.why", line 0, characters 0-0: *)
(*Why goal*) Lemma test2_impl_po_1 : 
  forall (alloc: alloc_table),
  forall (balance: ((memory) Z)),
  forall (result: pointer),
  forall (HW_1: (* File \"purse.c819618234.c1069824147.i\", line 0, characters 30-92 *)
                (((fresh alloc result) /\
                (purse_inv balance alloc result)) /\ (acc balance result) =
                0)),
  forall (result0: pointer),
  forall (HW_2: (* File \"purse.c819618234.c1069824147.i\", line 0, characters 30-92 *)
                (((fresh alloc result0) /\
                (purse_inv balance alloc result0)) /\ (acc balance result0) =
                0)),
  forall (balance0: ((memory) Z)),
  forall (HW_3: (* File \"<built-in>\", line 0, characters 6-56 *)
                ((purse_inv balance0 alloc result) /\ (acc balance0 result) =
                ((acc balance result) + 100)) /\
                (not_assigns alloc balance balance0 (pset_singleton result))),
  forall (balance1: ((memory) Z)),
  forall (HW_4: (* File \"<built-in>\", line 0, characters 6-56 *)
                ((purse_inv balance1 alloc result0) /\
                (acc balance1 result0) = ((acc balance0 result0) + 200)) /\
                (not_assigns alloc balance0 balance1 (pset_singleton result0))),
  forall (balance2: ((memory) Z)),
  forall (HW_5: (* File \"<command line>\", line 0, characters 3-53 *)
                ((purse_inv balance2 alloc result) /\ (acc balance2 result) =
                ((acc balance1 result) - 50)) /\
                (not_assigns alloc balance1 balance2 (pset_singleton result))),
  forall (balance3: ((memory) Z)),
  forall (HW_6: (* File \"<command line>\", line 0, characters 3-53 *)
                ((purse_inv balance3 alloc result0) /\
                (acc balance3 result0) = ((acc balance2 result0) - 100)) /\
                (not_assigns alloc balance2 balance3 (pset_singleton result0))),
  forall (result1: Z),
  forall (HW_7: result1 = (acc balance3 result)),
  forall (result2: Z),
  forall (HW_8: result2 = (acc balance3 result0)),
  (* File \"purse.c819618234.c1069824147.i\", line 0, characters 9-23 *)
  (result1 + result2) = 150.
Proof.
intuition.
Save.

(* Why obligation from file "why/purse.why", line 0, characters 0-0: *)
(*Why goal*) Lemma test2_impl_po_2 : 
  forall (alloc: alloc_table),
  forall (balance: ((memory) Z)),
  forall (result: pointer),
  forall (HW_1: (* File \"purse.c819618234.c1069824147.i\", line 0, characters 30-92 *)
                (((fresh alloc result) /\
                (purse_inv balance alloc result)) /\ (acc balance result) =
                0)),
  forall (result0: pointer),
  forall (HW_2: (* File \"purse.c819618234.c1069824147.i\", line 0, characters 30-92 *)
                (((fresh alloc result0) /\
                (purse_inv balance alloc result0)) /\ (acc balance result0) =
                0)),
  forall (balance0: ((memory) Z)),
  forall (HW_3: (* File \"<built-in>\", line 0, characters 6-56 *)
                ((purse_inv balance0 alloc result) /\ (acc balance0 result) =
                ((acc balance result) + 100)) /\
                (not_assigns alloc balance balance0 (pset_singleton result))),
  forall (balance1: ((memory) Z)),
  forall (HW_4: (* File \"<built-in>\", line 0, characters 6-56 *)
                ((purse_inv balance1 alloc result0) /\
                (acc balance1 result0) = ((acc balance0 result0) + 200)) /\
                (not_assigns alloc balance0 balance1 (pset_singleton result0))),
  forall (balance2: ((memory) Z)),
  forall (HW_5: (* File \"<command line>\", line 0, characters 3-53 *)
                ((purse_inv balance2 alloc result) /\ (acc balance2 result) =
                ((acc balance1 result) - 50)) /\
                (not_assigns alloc balance1 balance2 (pset_singleton result))),
  forall (balance3: ((memory) Z)),
  forall (HW_6: (* File \"<command line>\", line 0, characters 3-53 *)
                ((purse_inv balance3 alloc result0) /\
                (acc balance3 result0) = ((acc balance2 result0) - 100)) /\
                (not_assigns alloc balance2 balance3 (pset_singleton result0))),
  forall (result1: Z),
  forall (HW_7: result1 = (acc balance3 result)),
  (valid alloc result0).
Proof.
unfold purse_inv; intuition.
rewrite H11;auto.
apply pset_singleton_intro.
intro;subst.
generalize (fresh_not_valid alloc p1 H7 0).
intros Q ;apply Q.
rewrite shift_zero.
auto.
Save.

(* Why obligation from file "why/purse.why", line 0, characters 0-0: *)
(*Why goal*) Lemma test2_impl_po_3 : 
  forall (alloc: alloc_table),
  forall (balance: ((memory) Z)),
  forall (result: pointer),
  forall (HW_1: (* File \"purse.c819618234.c1069824147.i\", line 0, characters 30-92 *)
                (((fresh alloc result) /\
                (purse_inv balance alloc result)) /\ (acc balance result) =
                0)),
  forall (result0: pointer),
  forall (HW_2: (* File \"purse.c819618234.c1069824147.i\", line 0, characters 30-92 *)
                (((fresh alloc result0) /\
                (purse_inv balance alloc result0)) /\ (acc balance result0) =
                0)),
  forall (balance0: ((memory) Z)),
  forall (HW_3: (* File \"<built-in>\", line 0, characters 6-56 *)
                ((purse_inv balance0 alloc result) /\ (acc balance0 result) =
                ((acc balance result) + 100)) /\
                (not_assigns alloc balance balance0 (pset_singleton result))),
  forall (balance1: ((memory) Z)),
  forall (HW_4: (* File \"<built-in>\", line 0, characters 6-56 *)
                ((purse_inv balance1 alloc result0) /\
                (acc balance1 result0) = ((acc balance0 result0) + 200)) /\
                (not_assigns alloc balance0 balance1 (pset_singleton result0))),
  forall (balance2: ((memory) Z)),
  forall (HW_5: (* File \"<command line>\", line 0, characters 3-53 *)
                ((purse_inv balance2 alloc result) /\ (acc balance2 result) =
                ((acc balance1 result) - 50)) /\
                (not_assigns alloc balance1 balance2 (pset_singleton result))),
  forall (balance3: ((memory) Z)),
  forall (HW_6: (* File \"<command line>\", line 0, characters 3-53 *)
                ((purse_inv balance3 alloc result0) /\
                (acc balance3 result0) = ((acc balance2 result0) - 100)) /\
                (not_assigns alloc balance2 balance3 (pset_singleton result0))),
  (valid alloc result).
Proof.
unfold purse_inv; intuition.
rewrite H18;intuition.
apply pset_singleton_intro; auto.
intro;subst.
generalize (fresh_not_valid _ _ H1 0);rewrite shift_zero.
tauto.
rewrite H18;intuition.
apply pset_singleton_intro; auto.
intro;subst.
generalize (fresh_not_valid _ _ H1 0);rewrite shift_zero.
tauto.
Save.

(* Why obligation from file "why/purse.why", line 0, characters 0-0: *)
(*Why goal*) Lemma test2_impl_po_4 : 
  forall (alloc: alloc_table),
  forall (balance: ((memory) Z)),
  forall (result: pointer),
  forall (HW_1: (* File \"purse.c819618234.c1069824147.i\", line 0, characters 30-92 *)
                (((fresh alloc result) /\
                (purse_inv balance alloc result)) /\ (acc balance result) =
                0)),
  forall (result0: pointer),
  forall (HW_2: (* File \"purse.c819618234.c1069824147.i\", line 0, characters 30-92 *)
                (((fresh alloc result0) /\
                (purse_inv balance alloc result0)) /\ (acc balance result0) =
                0)),
  forall (balance0: ((memory) Z)),
  forall (HW_3: (* File \"<built-in>\", line 0, characters 6-56 *)
                ((purse_inv balance0 alloc result) /\ (acc balance0 result) =
                ((acc balance result) + 100)) /\
                (not_assigns alloc balance balance0 (pset_singleton result))),
  forall (balance1: ((memory) Z)),
  forall (HW_4: (* File \"<built-in>\", line 0, characters 6-56 *)
                ((purse_inv balance1 alloc result0) /\
                (acc balance1 result0) = ((acc balance0 result0) + 200)) /\
                (not_assigns alloc balance0 balance1 (pset_singleton result0))),
  forall (balance2: ((memory) Z)),
  forall (HW_5: (* File \"<command line>\", line 0, characters 3-53 *)
                ((purse_inv balance2 alloc result) /\ (acc balance2 result) =
                ((acc balance1 result) - 50)) /\
                (not_assigns alloc balance1 balance2 (pset_singleton result))),
  (* File \"purse.c819618234.c1069824147.i\", line 0, characters 10-46 *)
  ((purse_inv balance2 alloc result0) /\ 0 <= 100 /\ 100 <=
  (acc balance2 result0)).
Proof.
unfold purse_inv; intuition.
rewrite H26;intuition.
apply pset_singleton_intro; auto.
intro;subst.
generalize (fresh_not_valid _ _ H1 0);rewrite shift_zero.
tauto.
assert (not_in_pset p2 (pset_singleton p1)).
apply pset_singleton_intro.
intro;subst.
generalize (fresh_not_valid _ _ H1 0);rewrite shift_zero.
tauto.
rewrite H26;intuition.
Save.

(* Why obligation from file "why/purse.why", line 0, characters 0-0: *)
(*Why goal*) Lemma test2_impl_po_5 : 
  forall (alloc: alloc_table),
  forall (balance: ((memory) Z)),
  forall (result: pointer),
  forall (HW_1: (* File \"purse.c819618234.c1069824147.i\", line 0, characters 30-92 *)
                (((fresh alloc result) /\
                (purse_inv balance alloc result)) /\ (acc balance result) =
                0)),
  forall (result0: pointer),
  forall (HW_2: (* File \"purse.c819618234.c1069824147.i\", line 0, characters 30-92 *)
                (((fresh alloc result0) /\
                (purse_inv balance alloc result0)) /\ (acc balance result0) =
                0)),
  forall (balance0: ((memory) Z)),
  forall (HW_3: (* File \"<built-in>\", line 0, characters 6-56 *)
                ((purse_inv balance0 alloc result) /\ (acc balance0 result) =
                ((acc balance result) + 100)) /\
                (not_assigns alloc balance balance0 (pset_singleton result))),
  forall (balance1: ((memory) Z)),
  forall (HW_4: (* File \"<built-in>\", line 0, characters 6-56 *)
                ((purse_inv balance1 alloc result0) /\
                (acc balance1 result0) = ((acc balance0 result0) + 200)) /\
                (not_assigns alloc balance0 balance1 (pset_singleton result0))),
  (* File \"purse.c819618234.c1069824147.i\", line 0, characters 10-46 *)
  ((purse_inv balance1 alloc result) /\ 0 <= 50 /\ 50 <=
  (acc balance1 result)).
Proof.
intuition.
apply credit_impl_po_1 with 0 balance.
intuition.
Save.

(* Why obligation from file "why/purse.why", line 0, characters 0-0: *)
(*Why goal*) Lemma test2_impl_po_6 : 
  forall (alloc: alloc_table),
  forall (balance: ((memory) Z)),
  forall (result: pointer),
  forall (HW_1: (* File \"purse.c819618234.c1069824147.i\", line 0, characters 30-92 *)
                (((fresh alloc result) /\
                (purse_inv balance alloc result)) /\ (acc balance result) =
                0)),
  forall (result0: pointer),
  forall (HW_2: (* File \"purse.c819618234.c1069824147.i\", line 0, characters 30-92 *)
                (((fresh alloc result0) /\
                (purse_inv balance alloc result0)) /\ (acc balance result0) =
                0)),
  forall (balance0: ((memory) Z)),
  forall (HW_3: (* File \"<built-in>\", line 0, characters 6-56 *)
                ((purse_inv balance0 alloc result) /\ (acc balance0 result) =
                ((acc balance result) + 100)) /\
                (not_assigns alloc balance balance0 (pset_singleton result))),
  (* File \"purse.c819618234.c1069824147.i\", line 0, characters 10-32 *)
  ((purse_inv balance0 alloc result0) /\ 200 >= 0).
Proof.
intuition.
red in H16;tauto.
Save.

(* Why obligation from file "why/purse.why", line 0, characters 0-0: *)
(*Why goal*) Lemma test2_impl_po_7 : 
  forall (alloc: alloc_table),
  forall (balance: ((memory) Z)),
  forall (result: pointer),
  forall (HW_1: (* File \"purse.c819618234.c1069824147.i\", line 0, characters 30-92 *)
                (((fresh alloc result) /\
                (purse_inv balance alloc result)) /\ (acc balance result) =
                0)),
  forall (result0: pointer),
  forall (HW_2: (* File \"purse.c819618234.c1069824147.i\", line 0, characters 30-92 *)
                (((fresh alloc result0) /\
                (purse_inv balance alloc result0)) /\ (acc balance result0) =
                0)),
  (* File \"purse.c819618234.c1069824147.i\", line 0, characters 10-32 *)
  ((purse_inv balance alloc result) /\ 100 >= 0).
Proof.
intuition.
subst .
assert (p1<> p2).
intro;subst.
generalize (fresh_not_valid _ _ H6 0);rewrite shift_zero;tauto.
red in H7;intuition.
rewrite H27.
rewrite H25;intuition.
rewrite H23.
rewrite H19;intuition.
rewrite H17.
rewrite H13;intuition.
rewrite H12.
rewrite H8;intuition.
Save.

(* Why obligation from file "why/purse.why", line 0, characters 0-0: *)
(*Why goal*) Lemma withdraw_impl_po_1 : 
  forall (p: pointer),
  forall (s: Z),
  forall (alloc: alloc_table),
  forall (balance: ((memory) Z)),
  forall (HW_1: (* File \"purse.c819618234.c1069824147.i\", line 0, characters 10-46 *)
                ((purse_inv balance alloc p) /\ 0 <= s /\ s <=
                (acc balance p))),
  forall (result: Z),
  forall (HW_2: result = (acc balance p)),
  forall (balance0: ((memory) Z)),
  forall (HW_3: balance0 = (upd balance p (result - s))),
  (* File \"<command line>\", line 0, characters 3-53 *)
  ((purse_inv balance0 alloc p) /\ (acc balance0 p) = ((acc balance p) - s)) /\
  (not_assigns alloc balance balance0 (pset_singleton p)).
Proof.
unfold purse_inv; intuition.
Save.

(* Why obligation from file "why/purse.why", line 0, characters 0-0: *)
(*Why goal*) Lemma withdraw_impl_po_2 : 
  forall (p: pointer),
  forall (s: Z),
  forall (alloc: alloc_table),
  forall (balance: ((memory) Z)),
  forall (HW_1: (* File \"purse.c819618234.c1069824147.i\", line 0, characters 10-46 *)
                ((purse_inv balance alloc p) /\ 0 <= s /\ s <=
                (acc balance p))),
  forall (result: Z),
  forall (HW_2: result = (acc balance p)),
  (valid alloc p).
Proof.
unfold purse_inv; intuition.
subst; caduceus.
subst; caduceus.
Save.

(* Why obligation from file "why/purse.why", line 0, characters 0-0: *)
(*Why goal*) Lemma withdraw_impl_po_3 : 
  forall (p: pointer),
  forall (s: Z),
  forall (alloc: alloc_table),
  forall (balance: ((memory) Z)),
  forall (HW_1: (* File \"purse.c819618234.c1069824147.i\", line 0, characters 10-46 *)
                ((purse_inv balance alloc p) /\ 0 <= s /\ s <=
                (acc balance p))),
  (valid alloc p).
Proof.
intuition.
(* FILL PROOF HERE *)
Save.


(* This file was originally generated by why.
   It can be modified; only the generated parts will be overwritten. *)

Require Export caduceus_spec_why.

(* Why obligation from file "why/separation3.why", characters 632-709 *)
Lemma f2_impl_po_1 : 
  forall (alloc: alloc_table),
  forall (b: ((memory) pointer)),
  forall (l: pointer),
  forall (s0: pointer),
  forall (Pre13: (separation2 b b) /\ (valid1 b) /\
                 (valid_range alloc l 0 1) /\ (valid_range alloc s0 0 1) /\
                 (forall (index_0:pointer), (forall (index_1:pointer), True)) /\
                 (forall (index_6:pointer), (forall (index_7:pointer), True)) /\
                 (forall (index_12:pointer),
                  (forall (index_13:pointer), True)) /\
                 (separation_l_s0 s0 l) /\ (valid1_range b 5)),
  (valid alloc s0).
Proof.
intuition.
(* FILL PROOF HERE *)
Save.

(* Why obligation from file "why/separation3.why", characters 717-744 *)
Lemma f2_impl_po_2 : 
  forall (alloc: alloc_table),
  forall (b: ((memory) pointer)),
  forall (l: pointer),
  forall (s0: pointer),
  forall (Pre13: (separation2 b b) /\ (valid1 b) /\
                 (valid_range alloc l 0 1) /\ (valid_range alloc s0 0 1) /\
                 (forall (index_0:pointer), (forall (index_1:pointer), True)) /\
                 (forall (index_6:pointer), (forall (index_7:pointer), True)) /\
                 (forall (index_12:pointer),
                  (forall (index_13:pointer), True)) /\
                 (separation_l_s0 s0 l) /\ (valid1_range b 5)),
  forall (Pre4: (valid alloc s0)),
  forall (caduceus_4: pointer),
  forall (Post3: caduceus_4 = (shift (acc b s0) 2)),
  (valid alloc caduceus_4).
Proof.
intuition; subst.
unfold valid1_range in H13.
generalize (H13 s0 alloc Pre4); intuition.
Save.

(* Why obligation from file "why/separation3.why", characters 615-744 *)
Lemma f2_impl_po_3 : 
  forall (alloc: alloc_table),
  forall (b: ((memory) pointer)),
  forall (intP: ((memory) Z)),
  forall (l: pointer),
  forall (p: ((memory) pointer)),
  forall (s0: pointer),
  forall (Pre13: (separation2 b b) /\ (valid1 b) /\
                 (valid_range alloc l 0 1) /\ (valid_range alloc s0 0 1) /\
                 (forall (index_0:pointer), (forall (index_1:pointer), True)) /\
                 (forall (index_6:pointer), (forall (index_7:pointer), True)) /\
                 (forall (index_12:pointer),
                  (forall (index_13:pointer), True)) /\
                 (separation_l_s0 s0 l) /\ (valid1_range b 5)),
  forall (Pre4: (valid alloc s0)),
  forall (caduceus_4: pointer),
  forall (Post3: caduceus_4 = (shift (acc b s0) 2)),
  forall (Pre3: (valid alloc caduceus_4)),
  forall (intP0: ((memory) Z)),
  forall (Post8: intP0 = (upd intP caduceus_4 1)),
  (forall (result:pointer),
   (result = l ->
    (forall (p0:((memory) pointer)),
     (p0 = (upd p result s0) ->
      (((((forall (result:Z),
           (result = (acc intP0 (shift (acc b (acc p0 l)) 2)) -> result =
            1 /\
            (forall (index_0:pointer), (forall (index_1:pointer), True)) /\
            (forall (index_6:pointer), (forall (index_7:pointer), True)) /\
            (forall (index_12:pointer), (forall (index_13:pointer), True)))) /\
      (valid alloc l)) /\ (valid alloc (acc p0 l))) /\
      (valid alloc (acc p0 l))) /\
      (valid alloc (shift (acc b (acc p0 l)) 2))) /\
      (valid alloc (shift (acc b (acc p0 l)) 2)))) /\
    (valid alloc result))).
Proof.
intuition; subst; try caduceus.
valid.
Save.

(* Why obligation from file "why/separation3.why", characters 2090-2167 *)
Lemma f3_impl_po_1 : 
  forall (alloc: alloc_table),
  forall (b: ((memory) pointer)),
  forall (c: ((memory) pointer)),
  forall (s0: pointer),
  forall (Pre12: (separation2 b c) /\ (separation2 b b) /\ (valid1 c) /\
                 (valid1 b) /\ (valid_range alloc s0 0 1) /\
                 (separation2 c c) /\ (separation2 b c) /\
                 (forall (index_0:pointer), (forall (index_1:pointer), True)) /\
                 (separation1 b c) /\
                 (forall (index_6:pointer), (forall (index_7:pointer), True)) /\
                 (forall (index_12:pointer),
                  (forall (index_13:pointer), True)) /\
                 (valid1_range c 5) /\ (valid1_range b 5)),
  (valid alloc s0).
Proof.
intuition.
Save.

(* Why obligation from file "why/separation3.why", characters 2175-2202 *)
Lemma f3_impl_po_2 : 
  forall (alloc: alloc_table),
  forall (b: ((memory) pointer)),
  forall (c: ((memory) pointer)),
  forall (s0: pointer),
  forall (Pre12: (separation2 b c) /\ (separation2 b b) /\ (valid1 c) /\
                 (valid1 b) /\ (valid_range alloc s0 0 1) /\
                 (separation2 c c) /\ (separation2 b c) /\
                 (forall (index_0:pointer), (forall (index_1:pointer), True)) /\
                 (separation1 b c) /\
                 (forall (index_6:pointer), (forall (index_7:pointer), True)) /\
                 (forall (index_12:pointer),
                  (forall (index_13:pointer), True)) /\
                 (valid1_range c 5) /\ (valid1_range b 5)),
  forall (Pre4: (valid alloc s0)),
  forall (caduceus_5: pointer),
  forall (Post3: caduceus_5 = (shift (acc b s0) 2)),
  (valid alloc caduceus_5).
Proof.
intuition; subst.
generalize (H16 s0 alloc Pre4);
 intuition.
Save.

(* Why obligation from file "why/separation3.why", characters 2073-2202 *)
Lemma f3_impl_po_3 : 
  forall (alloc: alloc_table),
  forall (b: ((memory) pointer)),
  forall (c: ((memory) pointer)),
  forall (intP: ((memory) Z)),
  forall (s0: pointer),
  forall (Pre12: (separation2 b c) /\ (separation2 b b) /\ (valid1 c) /\
                 (valid1 b) /\ (valid_range alloc s0 0 1) /\
                 (separation2 c c) /\ (separation2 b c) /\
                 (forall (index_0:pointer), (forall (index_1:pointer), True)) /\
                 (separation1 b c) /\
                 (forall (index_6:pointer), (forall (index_7:pointer), True)) /\
                 (forall (index_12:pointer),
                  (forall (index_13:pointer), True)) /\
                 (valid1_range c 5) /\ (valid1_range b 5)),
  forall (Pre4: (valid alloc s0)),
  forall (caduceus_5: pointer),
  forall (Post3: caduceus_5 = (shift (acc b s0) 2)),
  forall (Pre3: (valid alloc caduceus_5)),
  forall (intP0: ((memory) Z)),
  forall (Post8: intP0 = (upd intP caduceus_5 1)),
  (forall (result:pointer),
   (result = (shift (acc c s0) 2) ->
    (forall (intP:((memory) Z)),
     (intP = (upd intP0 result 2) ->
      (((forall (result:Z),
         (result = (acc intP (shift (acc b s0) 2)) -> result = 1 /\
          (forall (index_0:pointer), (forall (index_1:pointer), True)) /\
          (forall (index_6:pointer), (forall (index_7:pointer), True)) /\
          (forall (index_12:pointer), (forall (index_13:pointer), True)))) /\
      (valid alloc s0)) /\ (valid alloc (shift (acc b s0) 2))) /\
      (valid alloc (shift (acc b s0) 2)))) /\
    (valid alloc result))) /\
  (valid alloc s0).
Proof.
intuition; subst; caduceus; auto.
rewrite acc_upd_neq.
caduceus.
generalize (H8 s0 ).
intros;apply neq_base_addr_neq_shift;intuition.
generalize (neq_base_addr_neq_shift (s0#c) (s0#b) 2 2).
intuition.
generalize (H14 s0 alloc Pre4);  intuition.
Save.

(* Why obligation from file "why/separation3.why", characters 3243-3267 *)
Lemma f_impl_po_1 : 
  forall (alloc: alloc_table),
  forall (l: pointer),
  forall (q: ((memory) pointer)),
  forall (s0: pointer),
  forall (Pre9: (separation2 q q) /\ (valid_range alloc l 0 1) /\
                (valid1 q) /\ (valid_range alloc s0 0 1) /\
                (forall (index_0:pointer), (forall (index_1:pointer), True)) /\
                (forall (index_6:pointer), (forall (index_7:pointer), True)) /\
                (forall (index_12:pointer), (forall (index_13:pointer), True)) /\
                (separation_l_s0 s0 l)),
  forall (caduceus_2: pointer),
  forall (Post3: caduceus_2 = s0),
  (valid alloc caduceus_2).
Proof.
intuition; subst; valid.
Save.

(* Why obligation from file "why/separation3.why", characters 3219-3267 *)
Lemma f_impl_po_2 : 
  forall (a: ((memory) Z)),
  forall (alloc: alloc_table),
  forall (l: pointer),
  forall (q: ((memory) pointer)),
  forall (s0: pointer),
  forall (Pre9: (separation2 q q) /\ (valid_range alloc l 0 1) /\
                (valid1 q) /\ (valid_range alloc s0 0 1) /\
                (forall (index_0:pointer), (forall (index_1:pointer), True)) /\
                (forall (index_6:pointer), (forall (index_7:pointer), True)) /\
                (forall (index_12:pointer), (forall (index_13:pointer), True)) /\
                (separation_l_s0 s0 l)),
  forall (caduceus_2: pointer),
  forall (Post3: caduceus_2 = s0),
  forall (Pre3: (valid alloc caduceus_2)),
  forall (a0: ((memory) Z)),
  forall (Post8: a0 = (upd a caduceus_2 1)),
  (forall (result:pointer),
   (result = (acc q l) ->
    (forall (a:((memory) Z)),
     (a = (upd a0 result 2) ->
      (forall (result:Z),
       (result = (acc a s0) -> result = 1 /\
        (forall (index_0:pointer), (forall (index_1:pointer), True)) /\
        (forall (index_6:pointer), (forall (index_7:pointer), True)) /\
        (forall (index_12:pointer), (forall (index_13:pointer), True)))) /\
      (valid alloc s0))) /\
    (valid alloc result))) /\
  (valid alloc l).
Proof.
intuition; subst; caduceus.
rewrite acc_upd_neq; caduceus.
rewrite <- (shift_zero (l#q)).
rewrite <- (shift_zero s0).
apply neq_base_addr_neq_shift.
red in H8.
inversion_clear H8.
inversion_clear H12.
inversion_clear H8.
auto.
generalize (H4 l alloc);intuition.
Save.

